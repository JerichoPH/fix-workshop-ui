(function(t){function e(e){for(var n,s,c=e[0],r=e[1],l=e[2],u=0,p=[];u<c.length;u++)s=c[u],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&p.push(i[s][0]),i[s]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);d&&d(e);while(p.length)p.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],n=!0,c=1;c<a.length;c++){var r=a[c];0!==i[r]&&(n=!1)}n&&(o.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},i={app:0},o=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/pda/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var d=r;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"035d":function(t,e,a){},1:function(t,e){},10:function(t,e){},11:function(t,e){},12:function(t,e){},13:function(t,e){},14:function(t,e){},2:function(t,e){},"24d3":function(t,e,a){},2884:function(t,e,a){"use strict";a("f588")},3:function(t,e){},4:function(t,e){},5:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{attrs:{view:"lHh Lpr lFf"}},["登录"!=t.$route.name&&"注册"!=t.$route.name?a("NavBar"):t._e(),a("q-page-container",{staticStyle:{flex:"1"}},[a("Fab",{directives:[{name:"show",rawName:"v-show",value:"登录"!=t.$route.name&&"注册"!=t.$route.name&&t.$store.state.showFab,expression:"\n        $route.name != '登录' && $route.name != '注册' && $store.state.showFab\n      "}],staticStyle:{"z-index":"90"}}),a("router-view")],1)],1)},o=[],s=(a("ac1f"),a("1276"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page-sticky",{staticClass:"flex",attrs:{position:"bottom-right",offset:t.fabPos}},[a("div",{staticClass:"q-mt-md"},[a("q-fab",{directives:[{name:"touch-pan",rawName:"v-touch-pan.prevent.mouse",value:t.moveFab,expression:"moveFab",modifiers:{prevent:!0,mouse:!0}}],attrs:{label:"快速访问","vertical-actions-align":"left",color:"purple",icon:"keyboard_arrow_down",direction:"up",disable:t.draggingFab},model:{value:t.fab2,callback:function(e){t.fab2=e},expression:"fab2"}},[a("q-fab-action",{attrs:{color:"primary",icon:"mail",label:"接口测试"},on:{click:t.apitest}}),a("q-fab-action",{attrs:{color:"secondary",icon:"alarm",label:"入库"},on:{click:function(e){return t.$router.push("/store")}}}),a("q-fab-action",{attrs:{color:"orange",icon:"airplay",label:"测试"},on:{click:function(e){return t.$router.push("/about")}}}),a("q-fab-action",{attrs:{color:"accent",icon:"room",label:"盘点"},on:{click:function(e){return t.$router.push("/check")}}}),a("q-fab-action",{attrs:{color:"accent",icon:"room",label:"首页"},on:{click:function(e){return t.$router.push("/")}}})],1)],1)])}),c=[],r={name:"Fab",data:function(){return{fabPos:[18,18],draggingFab:!1,fab2:!1}},methods:{onClick:function(){},moveFab:function(t){this.draggingFab=!0!==t.isFirst&&!0!==t.isFinal,this.fabPos=[this.fabPos[0]-t.delta.x,this.fabPos[1]-t.delta.y]},apitest:function(){console.log(this.$router.options.routes),this.$http.get("http://changsha.zhongchengkeshi.com/api/pdaBaseInfo").then((function(t){localStorage.setItem("basicinfo",JSON.stringify(t.data.data))})),navigator.onLine?this.$q.notify({message:"当前在线",type:"positive"}):this.$q.notify({message:"当前离线",type:"warning"})}}},l=r,d=a("2877"),u=a("de5e"),p=a("c294"),m=a("72db"),h=a("75c3"),f=a("93dc"),v=a.n(f),_=Object(d["a"])(l,s,c,!1,null,null,null),g=_.exports;v()(_,"components",{QPageSticky:u["a"],QFab:p["a"],QFabAction:m["a"]}),v()(_,"directives",{TouchPan:h["a"]});var b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("q-header",{attrs:{elevated:""}},[n("q-toolbar",[n("q-btn",{directives:[{name:"show",rawName:"v-show",value:"首页"!==t.$route.name,expression:"$route.name !== '首页'"}],attrs:{size:"sm",padding:"xs",flat:"",icon:"arrow_back_ios_new"},on:{click:function(e){return t.$router.go(-1)}}}),n("q-toolbar-title",{staticClass:"text-h6"},[n("strong",[t._v(t._s(t.$route.name))])]),t.$store.state.miniapp?n("q-btn",{attrs:{flat:"",icon:"search"},on:{click:t.showSearch}}):t._e(),t.$store.state.miniapp?t._e():n("div",[n("q-icon",{directives:[{name:"show",rawName:"v-show",value:t.onLine,expression:"onLine"}],attrs:{name:"signal_wifi_0_bar"}}),n("q-icon",{directives:[{name:"show",rawName:"v-show",value:!t.onLine,expression:"!onLine"}],staticClass:"text-orange",attrs:{name:"signal_wifi_off"}})],1),n("q-btn",{attrs:{flat:"",round:"",dense:""}},[n("q-icon",{attrs:{name:"more_vert"}}),n("q-menu",[n("div",{staticClass:"row no-wrap q-pa-md"},[t.$store.state.miniapp?t._e():n("div",{staticClass:"column"},[n("div",{staticClass:"text-h6 q-mb-md"},[t._v("应用设置")]),n("q-toggle",{attrs:{label:"启用浮动工具栏"},model:{value:t.$store.state.showFab,callback:function(e){t.$set(t.$store.state,"showFab",e)},expression:"$store.state.showFab"}}),n("q-toggle",{attrs:{label:"强制在线模式"},model:{value:t.$store.state.offlineMode,callback:function(e){t.$set(t.$store.state,"offlineMode",e)},expression:"$store.state.offlineMode"}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"更新应用",push:"",size:"sm"},on:{click:t.update}})],1),t.$store.state.miniapp?t._e():n("q-separator",{staticClass:"q-mx-lg",attrs:{vertical:"",inset:""}}),n("div",{staticClass:"column items-center"},[n("q-avatar",{attrs:{size:"72px"}},[n("img",{attrs:{src:a("d607")}})]),n("div",{staticClass:"text-subtitle1 q-mt-md q-mb-xs"},[t._v(t._s(t.username))]),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"退出登录",to:"/login",push:"",size:"sm"},on:{click:t.logout}})],1)],1)])],1)],1)],1)],1)},y=[],q=a("14b7"),k=a.n(q),C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{ref:"dialog",attrs:{"full-height":"",persistent:""},on:{hide:t.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("q-tabs",{staticClass:"bg-primary text-white relative",attrs:{dense:"","indicator-color":"purple",align:"justify"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab",{attrs:{name:"detail",label:"设备详情"}}),a("q-tab",{attrs:{name:"history",label:"设备履历"}}),"INSTALLED"===t.instance["state_code"]?a("q-tab",{attrs:{name:"loc",label:"现场备品定位"}}):t._e()],1),a("q-tab-panels",{attrs:{animated:"",swipeable:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab-panel",{staticStyle:{"overflow-y":"auto",height:"calc(100vh - 160px)"},attrs:{name:"detail"}},[a("div",{staticClass:"text-h6"},[t._v("设备详情")]),t._l(t.render,(function(e,n){return a("q-item",{key:n,staticClass:"ellipsis",attrs:{dense:""}},[t._v(" "+t._s(e[0])+":"),a("q-space"),t._v(" "+t._s("http://iot.api.in3km.com"!==t.instance[e[1]]?t.instance[e[1]]:"")+" ")],1)}))],2),a("q-tab-panel",{attrs:{name:"history"}},[a("div",{staticClass:"text-h6"},[t._v("设备履历")]),a("q-timeline",{staticStyle:{"overflow-y":"auto",height:"calc(100vh - 170px)"},attrs:{color:"primary"}},t._l(t.logs,(function(e){return a("q-timeline-entry",{key:e.date,attrs:{title:e.name,subtitle:e.created_at.split(" ")[0]}},[a("div",[t._v(t._s(e.description))])])})),1)],1),"INSTALLED"===t.instance["state_code"]?a("q-tab-panel",{attrs:{name:"loc"}},[a("div",{staticClass:"text-h6"},[t._v("现场备品定位")]),a("q-item",[t._v("所属车间车站:"+t._s(t.loc[0]["name"])+"，"+t._s(t.loc[1]["name"]))]),a("q-item",[t._v("备品数量:"+t._s(t.loc[0]["count"])+"，"+t._s(t.loc[1]["count"]))])],1):t._e()],1),"detail"===t.tab?a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"关闭"},on:{click:t.onCancelClick}})],1):t._e()],1)],1)},w=[],$=(a("99af"),{name:"detail",props:["ucode"],data:function(){return{url:null,instance:{},logs:[],loc:[],tab:"detail",render:[["唯一编码","identity_code"],["所编号","serial_number"],["种类","category_name"],["类型","model_name"],["型号","sub_model_name"],["使用年限","service_life"],["到期时间","scarping_at"],["供应商","factory_name"],["出厂日期","made_at"],["仓库位置","location_name"],["安装位置","maintain_location_code"],["状态","status"],["车间","maintain_workshop_name"],["车站","maintain_station_name"]]}},computed:{unique_code:function(){return this.ucode}},methods:{toggle:function(){this.url=null===this.url?"".concat(window.location.protocol,"//").concat(window.location.host)+this.instance.location_image:null},show:function(){var t=this,e=this.unique_code;this.$http.get("entireInstanceByIdentityCode/".concat(e)).then((function(e){t.instance=e.data.data.entire_instance,t.logs=e.data.data.entire_instance.entire_instance_logs,t.$refs.dialog.show()})).catch((function(e){var a=e.response;t.$q.notify({message:a.data.msg,type:"warning",position:"top"})}))},hide:function(){this.$refs.dialog.hide()},onDialogHide:function(){this.$emit("hide")},onOKClick:function(){this.$emit("ok"),this.hide()},onCancelClick:function(){this.hide()}}}),x=$,Q=a("24e8"),O=a("f09f"),S=a("429b"),D=a("7460"),L=a("adad"),j=a("823b"),I=a("66e5"),T=a("2c91"),R=a("9c40"),E=a("068f"),P=a("05eb"),N=a("74af"),A=a("4b7e"),z=Object(d["a"])(x,C,w,!1,null,"521a7c9e",null),Y=z.exports;v()(z,"components",{QDialog:Q["a"],QCard:O["a"],QTabs:S["a"],QTab:D["a"],QTabPanels:L["a"],QTabPanel:j["a"],QItem:I["a"],QSpace:T["a"],QBtn:R["a"],QImg:E["a"],QTimeline:P["a"],QTimelineEntry:N["a"],QCardActions:A["a"]});var B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{ref:"dialog",attrs:{maximized:""},on:{hide:t.onDialogHide,click:function(e){return t.hide()}}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("qrcode-stream",{on:{decode:t.onDecode}})],1)],1)},W=[],M={name:"detail",data:function(){return{expanded:!1,receipt:{},detail:{},items:{}}},methods:{onDecode:function(t){this.$emit("ok",t),this.$refs.dialog.hide()},show:function(){this.$refs.dialog.show()},hide:function(){this.$refs.dialog.hide()},onDialogHide:function(){this.$emit("hide")},onOKClick:function(){this.$emit("ok"),this.hide()},onCancelClick:function(){this.hide()}}},H=M,F=Object(d["a"])(H,B,W,!1,null,"037c345a",null),K=F.exports;v()(F,"components",{QDialog:Q["a"],QCard:O["a"]});var U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{ref:"dialog",attrs:{position:"top"},on:{hide:t.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("q-card-section",{staticClass:"row items-center q-pb-none"},[a("div",{staticClass:"text-h6"},[t._v("配置网络")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"85%"}},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",label:"转发地址(不使用转发请不填)",dense:""},model:{value:t.transmit,callback:function(e){t.transmit=e},expression:"transmit"}}),a("q-input",{attrs:{outlined:"",label:"目标地址",dense:""},model:{value:t.target,callback:function(e){t.target=e},expression:"target"}})],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"确认"},on:{click:t.onOKClick}}),a("q-btn",{attrs:{color:"primary",label:"取消"},on:{click:t.onCancelClick}})],1)],1)],1)},V=[],J=a("1da1"),G=(a("d3b7"),a("3ca3"),a("ddb0"),a("96cf"),a("81c3")),Z=G["a"].Storage,X={name:"config",data:function(){return{transmit:"",target:""}},methods:{getStorage:function(){var t=this;return Object(J["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Z.get({key:"transmit_url"});case 2:return t.transmit=e.sent.value,console.log(t.transmit),e.next=6,Z.get({key:"target_url"});case 6:t.target=e.sent.value;case 7:case"end":return e.stop()}}),e)})))()},show:function(){this.getStorage(),this.$refs.dialog.show()},hide:function(){this.$refs.dialog.hide()},onDialogHide:function(){this.$emit("hide")},onOKClick:function(){var t=this,e=Z.set({key:"transmit_url",value:this.transmit}),a=Z.set({key:"target_url",value:this.target});Promise.all([e,a]).then((function(){t.$emit("ok"),t.hide(),""==t.transmit||null==t.transmit||"null"==t.transmit?t.$http.defaults.baseURL="http://".concat(t.target,"/api/pda"):t.$http.defaults.baseURL="http://".concat(t.transmit,"/api/transmit?target=http://").concat(t.target,"/api/pda")}))},onCancelClick:function(){this.hide()}}},tt=X,et=a("a370"),at=a("eb85"),nt=a("27f9"),it=a("7f67"),ot=Object(d["a"])(tt,U,V,!1,null,"255a1602",null),st=ot.exports;v()(ot,"components",{QDialog:Q["a"],QCard:O["a"],QCardSection:et["a"],QSpace:T["a"],QBtn:R["a"],QSeparator:at["a"],QInput:nt["a"],QCardActions:A["a"]}),v()(ot,"directives",{ClosePopup:it["a"]});var ct={name:"NavBar",mounted:function(){window.addEventListener("online",this.updateOnlineStatus),window.addEventListener("offline",this.updateOnlineStatus);var t=new Image;t.src=a("d607")},created:function(){var t=localStorage.getItem("token"),e=k.a.decode(t);this.username=e.payload.nickname,this.$store.state.userInfo=e.payload},data:function(){return{onLine:navigator.onLine,username:"",text:""}},methods:{showSearch:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.$q.dialog({title:"搜索",message:"输入设备码",prompt:{model:"".concat(a),type:"text"},ok:{label:"搜索"},position:"top",cancel:!0,persistent:!0}).onOk((function(e){t.$q.dialog({component:Y,parent:t,ucode:e}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}))}))}})},update:function(){this.$q.dialog({component:st,parent:this}).onOk((function(){}))},showQR:function(){var t=this;this.$q.dialog({component:K,parent:this}).onOk((function(e){t.text=e,t.showDetail(),console.log("OK")})).onCancel((function(){console.log("Cancel")})).onDismiss((function(){console.log("Called on OK or Cancel")}))},showDetail:function(){this.$q.dialog({component:Y,parent:this,ucode:this.text}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}))},updateOnlineStatus:function(t){var e=t.type;this.onLine="online"===e},logout:function(){this.$q.notify({message:"退出登录成功",position:"top",type:"positive"}),localStorage.clear()}},beforeDestroy:function(){window.removeEventListener("online",this.updateOnlineStatus),window.removeEventListener("offline",this.updateOnlineStatus)}},rt=ct,lt=a("e359"),dt=a("65c6"),ut=a("6ac5"),pt=a("0016"),mt=a("4e73"),ht=a("9564"),ft=a("cb32"),vt=Object(d["a"])(rt,b,y,!1,null,"29f0b2a8",null),_t=vt.exports;v()(vt,"components",{QHeader:lt["a"],QToolbar:dt["a"],QBtn:R["a"],QToolbarTitle:ut["a"],QInput:nt["a"],QIcon:pt["a"],QMenu:mt["a"],QToggle:ht["a"],QSeparator:at["a"],QAvatar:ft["a"]}),v()(vt,"directives",{ClosePopup:it["a"]});var gt={name:"LayoutDefault",components:{Fab:g,NavBar:_t},created:function(){var t=this;this.$wx.miniProgram.getEnv((function(e){e.miniprogram&&(document.title="合肥电务段",console.log("aaaa"),t.$store.state.miniapp=!0,t.$http.get("https://test.hefei.zhongchengkeshi.com/api/wechatMiniApp/jsApiSignature?url=".concat(location.href.split("#")[0])).then((function(e){console.log("bbb");var a=e.data.data,n=a.noncestr,i=a.timestamp,o=a.signature,s=a.app_id;t.$wx.config({debug:!1,appId:s,timestamp:i,nonceStr:n,signature:o,jsApiList:["scanQRCode","chooseImage","getLocalImgData"]})})))}))}},bt=gt,yt=a("4d5a"),qt=a("09e3"),kt=Object(d["a"])(bt,i,o,!1,null,null,null),Ct=kt.exports;v()(kt,"components",{QLayout:yt["a"],QPageContainer:qt["a"]});var wt=a("8c4f"),$t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"row q-col-gutter-xs"},[a("q-card",{staticClass:"bg-grey-4 col-6",staticStyle:{"text-align":"center","vertical-align":"center"},on:{click:t.showSearch}},[a("q-card-section",{staticClass:"fix-center"},[a("q-icon",{staticStyle:{"font-size":"4rem"},attrs:{name:"search"}}),a("div",{staticClass:"text-h6"},[t._v("设备详情查询")])],1),a("q-card-section",{staticClass:"q-pt-none"})],1),t._l(t.navs,(function(e,n){return a("q-card",{directives:[{name:"show",rawName:"v-show",value:!e.hidden&&(!t.$store.state.miniapp||!e.hidden_inminiapp),expression:"\n          !nav.hidden && (!$store.state.miniapp || !nav.hidden_inminiapp)\n        "}],key:n,class:e.class+" col-6",staticStyle:{"text-align":"center","vertical-align":"center"},on:{click:function(a){return t.navFn(e.path)}}},[a("q-card-section",{staticClass:"fix-center"},[a("q-icon",{staticStyle:{"font-size":"4rem"},attrs:{name:e.icon}}),a("div",{staticClass:"text-h6"},[t._v(t._s(e.name))])],1),a("q-card-section",{staticClass:"q-pt-none"})],1)}))],2)])])},xt=[],Qt=(a("4de4"),a("5319"),{data:function(){return{navs:[]}},created:function(){this.navs=this.$router.options.routes.filter((function(t){return"/login"!=t.path&&"/"!=t.path&&"/regsiter"!=t.path}))},methods:{showSearch:function(){var t=this;this.$q.dialog({title:"搜索",message:"输入设备码",prompt:{model:"",type:"text"},ok:{label:"搜索"},position:"top",cancel:!0,persistent:!0}).onOk((function(e){t.$q.dialog({component:Y,parent:t,ucode:e}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}))}))},navFn:function(t){0!==t.indexOf(":id")?this.$router.push(t.replace(":id","")):this.$router.push(t)}}}),Ot=Qt,St=Object(d["a"])(Ot,$t,xt,!1,null,"9fb375d0",null),Dt=St.exports;v()(St,"components",{QCard:O["a"],QCardSection:et["a"],QIcon:pt["a"]});var Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("测试安卓接口功能")]),a("h2",[t._v(t._s(t.date))]),a("div",{staticClass:"q-pa-md"},[a("q-table",{attrs:{title:"缓存",data:t.data,columns:t.columns,"row-key":"name"}})],1),a("div",{staticClass:"q-pa-md column items-center"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-复位Web端首页",push:"",size:"lg"},on:{click:t.testReset}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-清空Web端缓存",push:"",size:"lg"},on:{click:t.testClear}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-更新Web端缓存",push:"",size:"lg"},on:{click:t.testUpdate}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-参数-所有",push:"",size:"lg"},on:{click:t.testParameterAll}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-参数-清空",push:"",size:"lg"},on:{click:t.testParameterClear}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-参数-查询",push:"",size:"lg"},on:{click:t.testParameterQuery}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-参数-删除",push:"",size:"lg"},on:{click:t.testParameterDelete}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-参数-插入",push:"",size:"lg"},on:{click:t.testParameterInsert}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-参数-更新",push:"",size:"lg"},on:{click:t.testParameterUpdate}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-缓存-写入",push:"",size:"lg"},on:{click:t.testCachePut}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-缓存-读取",push:"",size:"lg"},on:{click:t.testCacheGet}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-缓存-数量",push:"",size:"lg"},on:{click:t.testCacheSize}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-缓存-去除",push:"",size:"lg"},on:{click:t.testCacheRemove}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-缓存-清空",push:"",size:"lg"},on:{click:t.testCacheClear}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-CAD-访问",push:"",size:"lg"},on:{click:t.testCADAccess}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"测试-CAD-文件集",push:"",size:"lg"},on:{click:t.testCADFiles}})],1)])},jt=[],It={data:function(){return{columns:[{name:"key",label:"键",align:"left",field:function(t){return t.key},format:function(t){return"".concat(t)}},{name:"value",align:"right",label:"值",field:"value"}],data:[],date:""}},methods:{testReset:function(){this.$reset()},testClear:function(){this.$clear()},testUpdate:function(){this.$update()},testParameterAll:function(){var t=this.$pall();console.log(JSON.parse(t)),this.data=JSON.parse(t)},testParameterClear:function(){this.$pclear()},testParameterQuery:function(){var t=this;this.$q.dialog({title:"测试",message:"输入查询项",prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk((function(e){console.log(e),t.$q.notify({message:window.AndroidWebView.ParameterQuery(e),type:"positive",position:"top"})}))},testParameterDelete:function(){var t=this;this.$q.dialog({title:"测试",message:"输入删除项",prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk((function(e){t.$pdelete(e)}))},testParameterInsert:function(){var t=this;this.$q.dialog({title:"测试",message:"输入插入项(逗号分隔k,v)",prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk((function(e){t.$pinsert(e.split(",")[0],e.split(",")[1])}))},testParameterUpdate:function(){var t=this;this.$q.dialog({title:"测试",message:"输入修改项(逗号分隔k,v)",prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk((function(e){t.$pupdate(e.split(",")[0],e.split(",")[1])}))},testCachePut:function(){var t=new Date,e=t.toLocaleTimeString(),a=window.AndroidWebView.CachePut("cache-"+e);document.getElementById("testLog").value=a},testCacheGet:function(){var t=window.AndroidWebView.CacheGet(!0);document.getElementById("testLog").value=t},testCacheSize:function(){var t=window.AndroidWebView.CacheSize();document.getElementById("testLog").value=t},testCacheRemove:function(){var t=window.AndroidWebView.CacheRemove(0);document.getElementById("testLog").value=t},testCacheClear:function(){var t=window.AndroidWebView.CacheClear();document.getElementById("testLog").value=t},testCADAccess:function(){var t=window.AndroidWebView.CADAccess("sample.dwg");document.getElementById("testLog").value=t},testCADFiles:function(){var t=window.AndroidWebView.CADFiles();document.getElementById("testLog").value=t}},created:function(){this.date=this.$date.formatDate(Date.now(),"YYYY-MM-DD  HH:mm:ss Z")}},Tt=It,Rt=a("eaac"),Et=Object(d["a"])(Tt,Lt,jt,!1,null,"0fc6b4d0",null),Pt=Et.exports;v()(Et,"components",{QTable:Rt["a"],QBtn:R["a"]}),v()(Et,"directives",{ClosePopup:it["a"]});var Nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-layout",[n("q-page-container",[n("q-page",{staticClass:"flex bg-image flex-center"},[n("q-card",{style:t.$q.screen.lt.sm?{width:"80%"}:{width:"30%"}},[n("q-card-section",[n("q-avatar",{staticClass:"absolute-center shadow-10",attrs:{size:"103px"}},[n("img",{attrs:{src:a("d607")}})])],1),n("q-card-section",[n("div",{staticClass:"text-center q-pt-lg"},[n("div",{staticClass:"col text-h6 ellipsis"},[t._v("登录")])])]),n("q-card-section",[n("q-form",{staticClass:"q-gutter-md"},[n("q-input",{attrs:{autocapitalize:"off",filled:"",label:"账号",placeholder:"请输入账号","lazy-rules":""},model:{value:t.ld.username,callback:function(e){t.$set(t.ld,"username",e)},expression:"ld.username"}}),n("q-input",{attrs:{type:"password",filled:"",placeholder:"请输入密码",label:"密码","lazy-rules":""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login.apply(null,arguments)}},model:{value:t.ld.password,callback:function(e){t.$set(t.ld,"password",e)},expression:"ld.password"}}),n("div",[n("q-btn",{staticClass:"full-width",attrs:{label:"登录",type:"button",color:"primary"},on:{click:t.login}})],1),n("div",[n("q-btn",{staticClass:"full-width",staticStyle:{"margin-top":"-10px"},attrs:{label:"前往注册",flat:"",type:"button",color:"primary",to:"/regsiter"}})],1),t.$store.state.miniapp?t._e():n("div",[n("q-btn",{staticClass:"full-width",staticStyle:{"margin-top":"-20px"},attrs:{label:"修改项目地址",flat:"",type:"button",size:"md",color:"primary"},on:{click:t.update}})],1)],1)],1)],1)],1)],1)],1)},At=[],zt=(a("7db0"),{data:function(){return{ld:{username:"",password:""}}},created:function(){console.log(this.$route.params),this.$route.params&&(this.ld.username=this.$route.params.account,this.ld.password=this.$route.params.password)},methods:{login:function(){var t=this;if(navigator.onLine)this.$q.loadingBar.start(),this.$http.post("login",{account:this.ld.username,password:this.ld.password}).then((function(e){console.log(e),t.$store.state.userLevel=e.data.data.account.rank.code,t.$q.loadingBar.stop(),200==e.data.status?(t.$q.notify({message:"登录成功",type:"positive",position:"top"}),localStorage.setItem("token",e.data.data.jwt),t.$in_miniapp,t.$router.push("/")):t.$q.notify({message:e.data.message,type:"warning",position:"top"})})).catch((function(e){console.log(e),t.$q.notify({message:"登录请求失败",type:"warning",position:"top"})}));else{var e=localStorage.getItem("basicinfo");e=JSON.parse(e);var a=this.$bcrypt.compareSync(this.ld.password,e.accounts.find((function(e){return e.account==t.ld.username})).password);if(this.$q.notify({message:a?"离线Hash验证成功":"离线Hash验证错误",type:a?"positive":"warning",position:"top"}),a){var n=k.a.sign({aud:e.accounts.find((function(e){return e.account==t.ld.username})).nickname},"test");localStorage.setItem("token",n),this.$router.push("/")}}},update:function(){this.$q.dialog({component:st,parent:this}).onOk((function(){}))}}}),Yt=zt,Bt=(a("d6db"),a("9989")),Wt=a("0378"),Mt=Object(d["a"])(Yt,Nt,At,!1,null,null,null),Ht=Mt.exports;v()(Mt,"components",{QLayout:yt["a"],QPageContainer:qt["a"],QPage:Bt["a"],QCard:O["a"],QCardSection:et["a"],QAvatar:ft["a"],QForm:Wt["a"],QInput:nt["a"],QBtn:R["a"]});var Ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-layout",[n("q-page-container",[n("q-page",{staticClass:"flex bg-image flex-center"},[n("q-card",{style:t.$q.screen.lt.sm?{width:"80%"}:{width:"30%"}},[n("q-card-section",[n("q-avatar",{staticClass:"absolute-center shadow-10",attrs:{size:"103px"}},[n("img",{attrs:{src:a("d607")}})])],1),n("q-card-section",[n("div",{staticClass:"text-center q-pt-lg"},[n("div",{staticClass:"col text-h6 ellipsis"},[t._v("注册")])])]),n("q-card-section",[n("q-form",{staticClass:"q-gutter-md"},[n("q-input",{attrs:{dense:"",autocapitalize:"off",filled:"",label:"账号",placeholder:"请输入账号","lazy-rules":""},model:{value:t.ld.account,callback:function(e){t.$set(t.ld,"account",e)},expression:"ld.account"}}),n("q-input",{attrs:{dense:"",autocapitalize:"off",filled:"",label:"名称",placeholder:"请输入名称","lazy-rules":""},model:{value:t.ld.nickname,callback:function(e){t.$set(t.ld,"nickname",e)},expression:"ld.nickname"}}),n("q-input",{attrs:{dense:"",type:"password",filled:"",placeholder:"请输入密码",label:"密码","lazy-rules":""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.regsiter.apply(null,arguments)}},model:{value:t.ld.password,callback:function(e){t.$set(t.ld,"password",e)},expression:"ld.password"}}),n("Stations",{on:{workshop:t.handleWorkshop,station:t.handleStation}}),n("workareas",{ref:"workareas",on:{workarea:t.handleWorkarea}}),n("ranks",{on:{rank:t.handleRank}}),n("div",[n("q-btn",{staticClass:"full-width",attrs:{label:"注册",type:"button",color:"primary"},on:{click:t.regsiter}})],1),n("div",[n("q-btn",{staticClass:"full-width",staticStyle:{"margin-top":"-10px"},attrs:{label:"已经注册，前往登录",flat:"",type:"button",size:"sm",color:"primary",to:"/login"}})],1),t.$store.state.miniapp?t._e():n("div",[n("q-btn",{staticClass:"full-width",staticStyle:{"margin-top":"-20px"},attrs:{label:"修改IP地址",flat:"",type:"button",size:"sm",color:"primary"},on:{click:t.update}})],1)],1)],1)],1)],1)],1)],1)},Kt=[],Ut=a("5530"),Vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-none"},[a("div",{staticClass:"row"},[a("q-select",{staticClass:"col q-pr-xs",attrs:{dense:"",outlined:"",options:t.workshops,"map-options":"","options-dense":"","option-value":"unique_code","option-label":"name",label:"车间","emit-value":""},on:{filter:t.filterWorkshop,"filter-abort":t.abortFilterFn},model:{value:t.contact.workshop_unique_code,callback:function(e){t.$set(t.contact,"workshop_unique_code",e)},expression:"contact.workshop_unique_code"}}),a("q-select",{staticClass:"col q-pl-xs",attrs:{dense:"",outlined:"",options:t.stations,"map-options":"","options-dense":"","use-input":"","hide-selected":"","fill-input":"","option-value":"unique_code","option-label":"name",label:"车站","emit-value":""},on:{filter:t.filterStation,"filter-abort":t.abortFilterFn},model:{value:t.contact.station_unique_code,callback:function(e){t.$set(t.contact,"station_unique_code",e)},expression:"contact.station_unique_code"}})],1)])},Jt=[],Gt=a("2909"),Zt=(a("d81d"),a("b0c0"),{props:[],data:function(){return{stationsRaw:[],workshops:null,stations:null,contact:{workshop_unique_code:"",station_unique_code:""}}},watch:{"contact.workshop_unique_code":function(t){this.$emit("workshop",t),this.contact.station_unique_code=""},"contact.station_unique_code":function(t){this.$emit("station",this.stations.find((function(e){return e.unique_code==t})))}},methods:{abortFilterFn:function(){},filterWorkshop:function(t,e,a){var n=this;0===this.stationsRaw.length?this.$http.get("maintains").then((function(t){n.stationsRaw=t.data.data,e((function(){n.workshops=t.data.data}))})).catch((function(t){console.log(t),a()})):e((function(){n.workshops=n.stationsRaw}))},filterStation:function(t,e,a){var n=this;0===this.stationsRaw.length?this.$http.get("maintains").then((function(a){n.stationsRaw=a.data.data,e((function(){var e=[];""!=n.contact.workshop_unique_code?a.data.data.filter((function(t){return t.unique_code===n.contact.workshop_unique_code})).map((function(t){e.push.apply(e,Object(Gt["a"])(t.subset))})):a.data.data.map((function(t){e.push.apply(e,Object(Gt["a"])(t.subset))})),n.stations=""===t?e:e.filter((function(e){return e.name.indexOf(t)>-1}))}))})).catch((function(t){console.log(t),a()})):e((function(){var e=[];""!=n.contact.workshop_unique_code?n.stationsRaw.filter((function(t){return t.unique_code===n.contact.workshop_unique_code})).map((function(t){e.push.apply(e,Object(Gt["a"])(t.subset))})):n.stationsRaw.map((function(t){e.push.apply(e,Object(Gt["a"])(t.subset))})),n.stations=""===t?e:e.filter((function(e){return e.name.indexOf(t)>-1}))}))}}}),Xt=Zt,te=a("ddd8"),ee=Object(d["a"])(Xt,Vt,Jt,!1,null,null,null),ae=ee.exports;v()(ee,"components",{QSelect:te["a"]});var ne=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-none"},[a("div",{staticClass:"row"},[a("q-select",{staticClass:"col",attrs:{dense:"",outlined:"",options:t.workareas,"map-options":"","options-dense":"","option-value":"unique_code","option-label":"name",label:"工区","emit-value":""},model:{value:t.work_area_unique_code,callback:function(e){t.work_area_unique_code=e},expression:"work_area_unique_code"}})],1)])},ie=[],oe={props:[],data:function(){return{workareas:[],workareasRaw:[],work_area_unique_code:""}},watch:{work_area_unique_code:function(t){this.$emit("workarea",t)}},created:function(){var t=this;this.$http.get("workAreas").then((function(e){t.workareas=e.data.data.work_areas,t.workareasRaw=e.data.data.work_areas}))},methods:{abortFilterFn:function(){},filterWorkareas:function(t){this.work_area_unique_code="",this.workareas=this.workareasRaw.filter((function(e){return e.workshop_unique_code===t})),console.log(this.workareas)}}},se=oe,ce=Object(d["a"])(se,ne,ie,!1,null,null,null),re=ce.exports;v()(ce,"components",{QSelect:te["a"]});var le=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-none"},[a("div",{staticClass:"row"},[a("q-select",{staticClass:"col",attrs:{dense:"",outlined:"",options:t.ranks,"map-options":"","options-dense":"","option-value":"unique_code","option-label":"name",label:"职务","emit-value":""},model:{value:t.rank_code,callback:function(e){t.rank_code=e},expression:"rank_code"}})],1)])},de=[],ue=(a("4fad"),{props:[],data:function(){return{ranks:[],rank_code:""}},watch:{rank_code:function(t){this.$emit("rank",t)}},created:function(){var t=this;this.$http.get("ranks").then((function(e){t.ranks=Object.entries(e.data.data.ranks).map((function(t){return{name:t[1],unique_code:t[0]}})),t.rank_code="None"}))},methods:{abortFilterFn:function(){}}}),pe=ue,me=Object(d["a"])(pe,le,de,!1,null,null,null),he=me.exports;v()(me,"components",{QSelect:te["a"]});var fe={components:{Stations:ae,workareas:re,ranks:he},data:function(){return{ld:{account:"",password:"",nickname:"",workshop_unique_code:"",station_unique_code:"",work_area_unique_code:"",rank:""}}},methods:{handleWorkshop:function(t){this.ld.workshop_unique_code=t,this.$refs.workareas.filterWorkareas(t)},handleStation:function(t){this.ld.station_unique_code=t.unique_code},handleWorkarea:function(t){this.ld.work_area_unique_code=t},handleRank:function(t){this.ld.rank=t},update:function(){this.$q.dialog({component:st,parent:this}).onOk((function(){}))},regsiter:function(){var t=this;console.log(this.ld),this.$http.post("register",Object(Ut["a"])({},this.ld)).then((function(e){t.$q.notify({message:e.data.msg,type:"positive",position:"top"}),t.$router.push({name:"登录",params:Object(Ut["a"])({},t.ld)})})).catch((function(e){var a=e.response;console.log(a),t.$q.notify({message:a.data.msg,type:"warning",position:"top"})})),console.log("注册成功")}}},ve=fe,_e=(a("8a48"),Object(d["a"])(ve,Ft,Kt,!1,null,null,null)),ge=_e.exports;v()(_e,"components",{QLayout:yt["a"],QPageContainer:qt["a"],QPage:Bt["a"],QCard:O["a"],QCardSection:et["a"],QAvatar:ft["a"],QForm:Wt["a"],QInput:nt["a"],QBtn:R["a"]});var be=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("div",{staticClass:"q-gutter-sm row"},[a("q-radio",{staticClass:"col",attrs:{dense:"",val:"model",label:"按种类型搜索"},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}}),a("q-radio",{staticClass:"col",attrs:{dense:"",val:"loc",label:"按位置搜索"},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}})],1),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"search",label:"搜索"},on:{click:t.search}})],1),"loc"===t.mode?a("div",[a("q-expansion-item",{attrs:{label:"按位置搜索"}},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"位置编码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)}},model:{value:t.search_loc,callback:function(e){t.search_loc=e},expression:"search_loc"}}),a("Location",{on:{locChange:t.handleLoc}})],1)],1):t._e(),"model"===t.mode?a("div",[a("q-expansion-item",{attrs:{label:"按种类型搜索"}},[a("model",{on:{modelChange:t.handleModel}})],1)],1):t._e()]),a("div",{ref:"scrollTargetRef",staticClass:"q-pa-md",staticStyle:{"max-height":"calc(100vh - 280px)",overflow:"auto"}},[a("q-infinite-scroll",{attrs:{offset:200,"scroll-target":t.$refs.scrollTargetRef,disable:t.state},on:{load:t.appendSearch},scopedSlots:t._u([{key:"loading",fn:function(){return[a("div",{staticClass:"row justify-center q-my-md"},[a("q-spinner-dots",{attrs:{color:"primary",size:"40px"}})],1)]},proxy:!0}])},[a("SimpleList",{attrs:{Litems:t.items,showDelete:!1,slidable:!1}})],1)],1)])])},ye=[],qe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-list",{attrs:{bordered:"",separator:""}},t._l(t.items,(function(e,n){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,attrs:{clickable:"",active:e.active,"active-class":"bg-teal-1 text-grey-8"},on:{click:function(a){return t.showDetail(e.identity_code)}}},[a("q-item-section",[t.showCross?a("q-item-label",[t._v(" "+t._s(e.maintain_location_code)+t._s(e.crossroad_number)+" ")]):t._e(),t._v(" "+t._s(e.identity_code)+t._s(e.unique_code)+" "),a("q-item-label",[t._v(" "+t._s(e.category_name)+" "+t._s(e.model_name)+" ")]),a("q-item-label",[t._v(" "+t._s(e.sub_model_name)+" ")]),e.location_name?a("q-item-label",[t._v(" "+t._s(e.location_name)+" ")]):t._e()],1),e.check?a("q-item-section",[t._v(" "+t._s(e.check)+" ")]):t._e(),e.note?a("q-item-section",[t._v(" "+t._s(e.note)+" ")]):t._e(),""==!e.status?a("q-item-section",{staticClass:"text-black",staticStyle:{width:"55px","padding-right":"10px"},attrs:{thumbnail:""}},[t._v(" "+t._s(e.status)+" ")]):t._e(),t.AshowDelete?a("q-btn",{attrs:{size:"12px",flat:"",dense:"",round:"",icon:"delete",side:""},on:{click:function(a){return a.stopPropagation(),t.removeItem(n,e.identity_code)}}}):t._e()],1)})),1)],1)},ke=[],Ce=(a("a434"),{name:"simpleList",props:{Litems:{default:[]},showDelete:{default:!0},slidable:{default:!0},showCrossroad:{default:!1}},computed:{items:function(){return this.Litems},AshowDelete:function(){return this.showDelete},slide:function(){return this.slidable},showCross:function(){return this.showCrossroad}},methods:{onLeft:function(t,e){var a=t.reset;this.finalize(a),this.Litems[e].active=!0},onRight:function(t,e){var a=t.reset;this.finalize(a),this.Litems[e].active=!1},finalize:function(t){this.timer=setTimeout((function(){t()}),200)},removeItem:function(t,e){var a=this;this.$q.dialog({title:"确认删除？",message:"删除设备： ".concat(this.items[t].identity_code),ok:{color:"negative"},cancel:!0,persistent:!0}).onOk((function(){a.$emit("delete",e),a.items.splice(t,1)})).onCancel((function(){})).onDismiss((function(){}))},showDetail:function(t){this.$q.dialog({component:Y,parent:this,ucode:t}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}))}},beforeDestroy:function(){clearTimeout(this.timer)}}),we=Ce,$e=a("1c1c"),xe=a("de1d"),Qe=a("4074"),Oe=a("0170"),Se=a("714f"),De=Object(d["a"])(we,qe,ke,!1,null,"147b5e98",null),Le=De.exports;v()(De,"components",{QList:$e["a"],QSlideItem:xe["a"],QIcon:pt["a"],QItem:I["a"],QItemSection:Qe["a"],QItemLabel:Oe["a"],QBtn:R["a"]}),v()(De,"directives",{Ripple:Se["a"]});var je=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-tree",{attrs:{nodes:t.locations,"node-key":"unique_code","label-key":"name",selected:t.selected,"children-key":"subset"},on:{"update:selected":[t.selectaaa,function(e){t.selected=e}]}}),t._v(" "+t._s(t.selected)+" ")],1)},Ie=[],Te={name:"location",data:function(){return{selected:"",locations:[]}},mounted:function(){this.loadLocations()},methods:{selectaaa:function(t){console.log(t),this.$emit("locChange",t)},loadLocations:function(){var t=this,e=this.$q.notify({type:"ongoing",message:"正在获取位置数据...",position:"top"});this.$http.get("locations").then((function(a){t.locations=a.data.data,e({message:"获取位置信息成功",position:"top",type:"positive"})})).catch((function(t){var a=t.response;e({message:a.data.msg,position:"top",type:"warning"})}))}}},Re=Te,Ee=a("7f41"),Pe=Object(d["a"])(Re,je,Ie,!1,null,"1d4d0a35",null),Ne=Pe.exports;v()(Pe,"components",{QTree:Ee["a"]});var Ae=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-tree",{attrs:{nodes:t.models,"node-key":"unique_code","label-key":"name",selected:t.selected,"children-key":"subset"},on:{"update:selected":[t.selectaaa,function(e){t.selected=e}]}})],1)},ze=[],Ye={name:"model",data:function(){return{selected:"",models:[]}},mounted:function(){this.loadModels()},methods:{selectaaa:function(t){var e=t;console.log(t.length),3!==t.length?5!==t.length?this.$emit("modelChange",{category_unique_code:"",entire_model_unique_code:"",model_unique_code:e}):this.$emit("modelChange",{category_unique_code:"",entire_model_unique_code:e,model_unique_code:""}):this.$emit("modelChange",{category_unique_code:e,entire_model_unique_code:"",model_unique_code:""})},loadModels:function(){var t=this,e=this.$q.notify({type:"ongoing",message:"正在获取种类型数据...",position:"top"});this.$http.get("types").then((function(a){var n=a.data.data;t.models=n,e({message:"获取种类型信息成功",position:"top",type:"positive"})})).catch((function(t){var a=t.response;e({message:a.data.msg,position:"top",type:"warning"})}))}}},Be=Ye,We=Object(d["a"])(Be,Ae,ze,!1,null,"74eb29d6",null),Me=We.exports;v()(We,"components",{QTree:Ee["a"]});var He={components:{SimpleList:Le,Location:Ne,Model:Me},data:function(){return{mode:"model",searchData:"",items:[],page:1,state:!1,search_category_unique_code:"",search_entire_model_unique_code:"",search_model_unique_code:"",search_loc:""}},watch:{mode:function(){this.search_category_unique_code="",this.search_entire_model_unique_code="",this.search_model_unique_code="",this.search_loc="",this.state=!1,this.page=1,this.items=[],this.appendSearch()}},methods:{search:function(){var t=this;this.page=1,this.$http.get("entireInstances",{params:{category_unique_code:this.search_category_unique_code?this.search_category_unique_code:null,entire_model_unique_code:this.search_entire_model_unique_code?this.search_entire_model_unique_code:null,model_unique_code:this.search_model_unique_code?this.search_model_unique_code:null,"location_unique_code[operator]":this.search_loc?"like":null,"location_unique_code[value]":this.search_loc?this.search_loc+"%":null,page:1}}).then((function(e){t.items=e.data.data.data,t.page+=1})).catch((function(t){var e=t.response;console.log(e)}))},handleLoc:function(t){this.search_loc=t},handleModel:function(t){this.search_category_unique_code=t.category_unique_code,this.search_entire_model_unique_code=t.entire_model_unique_code,this.search_model_unique_code=t.model_unique_code},appendSearch:function(t,e){var a=this;this.$http.get("entireInstances",{params:{category_unique_code:this.search_category_unique_code?this.search_category_unique_code:null,entire_model_unique_code:this.search_entire_model_unique_code?this.search_entire_model_unique_code:null,model_unique_code:this.search_model_unique_code?this.search_model_unique_code:null,"location_unique_code[operator]":this.search_loc?"like":null,"location_unique_code[value]":this.search_loc?this.search_loc+"%":null,page:this.page}}).then((function(t){var n;(console.log(t),0!==t.data.data.data.length)?(a.page+=1,(n=a.items).push.apply(n,Object(Gt["a"])(t.data.data.data)),e()):(a.state=!0,e())})).catch((function(t){var e=t.response;console.log(e)}))}}},Fe=He,Ke=a("3786"),Ue=a("3b73"),Ve=a("ef35"),Je=a("8380"),Ge=Object(d["a"])(Fe,be,ye,!1,null,"20b0f971",null),Ze=Ge.exports;v()(Ge,"components",{QRadio:Ke["a"],QInput:nt["a"],QBtn:R["a"],QExpansionItem:Ue["a"],QInfiniteScroll:Ve["a"],QSpinnerDots:Je["a"]});var Xe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"位置码"},model:{value:t.positionCode,callback:function(e){t.positionCode=e},expression:"positionCode"}}),a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addToList.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.addToList}})]},proxy:!0}]),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}})],1),a("br"),a("q-card",{staticStyle:{height:"calc(100vh - 285px)","overflow-y":"auto"}},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items}})],1)],1),t.$store.state.miniapp?a("div",{staticClass:"q-pt-md row"},[a("q-btn",{staticClass:"col",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描位置码"},on:{click:t.scanLoc}}),a("q-btn",{staticClass:"col q-ml-sm",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描设备码"},on:{click:t.scanDevice}})],1):t._e(),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"exit_to_app",label:"入库"},on:{click:t.makeStore}})],1)],1)])},ta=[],ea={components:{simpleList:Le},data:function(){return{items:[],active:!0,deviceCode:"",positionCode:""}},methods:{scanLoc:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.positionCode=a}})},scanDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.deviceCode=a,t.addToList()}})},addToList:function(){var t=this;if(""!=this.deviceCode){var e=this.items.map((function(t){return t.unique_code}));-1===e.indexOf(this.deviceCode)?(this.$http.post("warehouseInOfSearch",{identity_code:this.deviceCode,location_unique_code:this.positionCode}).then((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data),{},{active:!1,location_unique_code:t.positionCode}))})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})})),this.deviceCode=""):this.$q.notify({type:"warning",position:"top",message:"此设备已经添加"})}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},makeStore:function(){var t=this;if(""!=this.items&&this.items!=[]){var e={datas:this.items,date:this.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")};console.log(e),this.$http.post("warehouseIn",e).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg})})),this.items=[]}else this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},aa=ea,na=a("4983"),ia=Object(d["a"])(aa,Xe,ta,!1,null,"45f0a55a",null),oa=ia.exports;v()(ia,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QScrollArea:na["a"],QCardSection:et["a"]});var sa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{dense:"",disable:"direct"===t.mode,outlined:"",autocapitalize:"off",label:"入柜设备/器材唯一编码",autofocus:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getNew.apply(null,arguments)}},model:{value:t.unique_code,callback:function(e){t.unique_code=e},expression:"unique_code"}}),a("q-input",{ref:"level",attrs:{dense:"",outlined:"",autocapitalize:"off",label:"入柜位置层编码"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getPosition.apply(null,arguments)}},model:{value:t.levelCode,callback:function(e){t.levelCode=e},expression:"levelCode"}}),a("device",{attrs:{item:t.newdevice}}),a("position",{attrs:{position:t.position_detail},on:{positionChange:t.test}}),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"file_upload",label:"现场备品入柜"},on:{click:t.makeInstall}})],1)],1)])},ca=[],ra=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-card",{attrs:{flat:"",bordered:""}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("设备/器材")])]),a("q-card-section",{staticClass:"q-pt-none"},[t._v(" 设备/器材唯一编码："+t._s(t.item.identity_code)+" ")]),a("q-card-section",{staticClass:"q-pt-none"},[t._v(" 种类："+t._s(t.item.category_name)+" ")]),a("q-card-section",{staticClass:"q-pt-none"},[t._v(" 类型："+t._s(t.item.model_name)+" ")]),a("q-card-section",{staticClass:"q-pt-none"},[t._v(" 设备/器材状态："+t._s(t.item.status)+" ")]),a("q-card-section",{staticClass:"q-pt-none"},[t._v(" 设备/器材位置："+t._s(t.item.maintain_station_name)+" "+t._s(t.item.maintain_location_code)+" ")])],1)],1)},la=[],da={name:"device",props:["type","item"],data:function(){return{ttype:this.type,iitem:this.item}}},ua=da,pa=Object(d["a"])(ua,ra,la,!1,null,null,null),ma=pa.exports;v()(pa,"components",{QCard:O["a"],QCardSection:et["a"]});var ha=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-card",{attrs:{flat:"",bordered:""}},[a("q-card-section",{staticClass:"q-py-xs"},[a("div",{staticClass:"text-h6"},[t._v("位置")])]),a("q-card-section",{staticClass:"q-py-xs"},[t._v(" 位置码（层）："+t._s(t.position.install_tier_unique_code)+" ")]),a("q-card-section",{staticClass:"q-py-xs"},[t._v(" 车间/车站： "+t._s(t.position.workshop_name?t.position.workshop_name+"/"+t.position.station_name:"")+" ")]),a("q-card-section",{staticClass:"q-py-xs"},[t._v(" 机房/排/柜架/层： "+t._s(t.position.room_name?t.position.room_name+"/"+t.position.platoon_name+"/"+t.position.shelf_name+"/"+t.position.tier_name:"")+" ")]),a("q-card-section",{staticClass:"q-pt-none"},[a("q-select",{staticClass:"q-mt-sm",attrs:{dense:"",outlined:"",options:t.position.positions,"map-options":"","options-dense":"","option-value":"unique_code","option-label":"name",label:"位","emit-value":""},model:{value:t.selected_position,callback:function(e){t.selected_position=e},expression:"selected_position"}})],1)],1)],1)},fa=[],va={name:"device",props:["type","position"],data:function(){return{selected_position:""}},watch:{selected_position:function(t){this.$emit("positionChange",t)}}},_a=va,ga=Object(d["a"])(_a,ha,fa,!1,null,null,null),ba=ga.exports;v()(ga,"components",{QCard:O["a"],QCardSection:et["a"],QSelect:te["a"]});var ya={components:{Device:ma,position:ba},data:function(){return{shape:"line",mode:"cycle",install:{new_identity_code:"",old_identity_code:"",maintain_location_code:""},unique_code:"",olddevice:{},newdevice:{},levelCode:"",position_detail:{},position:""}},methods:{test:function(t){this.position=t},makeInstall:function(){var t=this,e={status:"INSTALLING",date:this.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss"),maintain_location_code:this.position};this.$http.post("inDoorInstalledStrictAndInstalling/".concat(this.unique_code),e).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg})})).catch((function(e){var a=e.response;console.log(a),t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))},getNew:function(){var t=this;this.$http.get("installed",{params:{code:this.unique_code}}).then((function(e){t.newdevice=e.data.data[0],t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.$refs.level.focus()})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))},getPosition:function(){var t=this;this.$http.get("installPosition/byInstallTierUniqueCode/".concat(this.levelCode)).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.position_detail=Object(Ut["a"])(Object(Ut["a"])({},e.data.data),{},{install_tier_unique_code:t.levelCode})})).catch(this.$n_error)}}},qa=ya,ka=Object(d["a"])(qa,sa,ca,!1,null,"75890a87",null),Ca=ka.exports;v()(ka,"components",{QInput:nt["a"],QBtn:R["a"]});var wa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addToList.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.addToList}})]},proxy:!0}]),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}})],1),a("br"),a("q-card",{staticStyle:{height:"calc(100vh - 215px)","overflow-y":"auto"}},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,slidable:!1}})],1)],1),t.$store.state.miniapp?a("div",{staticClass:"q-pt-md row"},[a("q-btn",{staticClass:"col",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描设备码"},on:{click:t.scanDevice}})],1):t._e(),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"delete_sweep",label:"报废"},on:{click:t.makeScrap}})],1)],1)])},$a=[],xa={components:{simpleList:Le},data:function(){return{items:[],active:!0,deviceCode:""}},methods:{scanDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.deviceCode=a,t.addToList()}})},addToList:function(){var t=this;if(""!=this.deviceCode){var e=this.items.map((function(t){return t.identity_code}));-1===e.indexOf(this.deviceCode)?(this.$http.post("scrapOfSearch",{data:this.deviceCode}).then((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data),{},{active:!1}))})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})})),this.deviceCode=""):this.$q.notify({type:"warning",position:"top",message:"此设备已经添加"})}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},makeScrap:function(){var t=this;if(0!==this.items.length){var e={datas:this.items.map((function(t){return t.identity_code})),date:this.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")};console.log(e),this.$http.post("scrap",e).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=t.items.filter((function(t){return!t.active})),t.items=[]})).catch((function(e){var a=e.response;console.log(a),t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))}else this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},Qa=xa,Oa=Object(d["a"])(Qa,wa,$a,!1,null,"1d2f5da1",null),Sa=Oa.exports;v()(Oa,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QScrollArea:na["a"],QCardSection:et["a"]});var Da=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addToList.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.addToList}})]},proxy:!0}]),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}})],1),a("br"),a("q-card",{staticStyle:{height:"calc(100vh - 225px)","overflow-y":"auto"}},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,slidable:!1}})],1)],1),t.$store.state.miniapp?a("div",{staticClass:"q-pt-md row"},[a("q-btn",{staticClass:"col",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描设备码"},on:{click:t.scanDevice}})],1):t._e(),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"rule",label:"报损"},on:{click:t.makeDamage}})],1)],1)])},La=[],ja={components:{simpleList:Le},data:function(){return{items:[],active:!0,deviceCode:""}},methods:{scanDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.deviceCode=a,t.addToList()}})},addToList:function(){var t=this;if(""!=this.deviceCode){var e=this.items.map((function(t){return t.identity_code}));-1===e.indexOf(this.deviceCode)?(this.$http.post("frmLossOfSearch",{data:this.deviceCode}).then((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data),{},{active:!1}))})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})})),this.deviceCode=""):this.$q.notify({type:"warning",position:"top",message:"此设备已经添加"})}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},makeDamage:function(){var t=this;if(0!==this.items.length){var e={datas:this.items.map((function(t){return t.identity_code})),date:this.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")};console.log(e),this.$http.post("frmLoss",e).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=[]})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))}else this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},Ia=ja,Ta=Object(d["a"])(Ia,Da,La,!1,null,"1b2c106a",null),Ra=Ta.exports;v()(Ta,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QScrollArea:na["a"],QCardSection:et["a"]});var Ea=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",disable:t.state,dense:t.state,autocapitalize:"off",label:"盘点位置"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getCheckList.apply(null,arguments)}},scopedSlots:t._u([t.state?null:{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.getCheckList}})]},proxy:!0}],null,!0),model:{value:t.positionCode,callback:function(e){t.positionCode=e},expression:"positionCode"}}),t.state?a("q-input",{attrs:{outlined:"",dense:"",autocapitalize:"off",label:"盘点设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.preCheck.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.preCheck}})]},proxy:!0}],null,!1,648101733),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}}):t._e()],1),a("br"),a("q-card",{style:t.state?"height: calc(100vh - 255px);":"height: calc(100vh - 215px);overflow-y: auto; "},[a("q-card-section",[0!==t.items.length?a("simpleList",{attrs:{Litems:t.items,showDelete:!t.state,slidable:!1}}):t._e()],1)],1),t.$store.state.miniapp?a("div",{staticClass:"q-pt-md row"},[t.state?a("q-btn",{staticClass:"col",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描设备码"},on:{click:t.scanDevice}}):a("q-btn",{staticClass:"col",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描位置码"},on:{click:t.scanLoc}})],1):t._e(),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"fact_check",label:"盘点"},on:{click:t.makeCheck}})],1)],1)])},Pa=[],Na={components:{simpleList:Le},data:function(){return{state:!1,items:[],active:!0,deviceCode:"",positionCode:""}},methods:{scanLoc:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.positionCode=a,t.getCheckList()}})},scanDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.deviceCode=a,t.preCheck()}})},getCheckList:function(){var t=this;this.$http.post("takeStock/ready",{location_unique_code:this.positionCode}).then((function(e){var a=e.data.data;a.map((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e),{},{active:!1}))})),t.state=!0})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))},preCheck:function(){var t=this,e=this.items.find((function(e){return e.identity_code===t.deviceCode}));e?(this.$q.notify({type:"positive",position:"top",message:"盘点正常"}),e.active=!0,e.check="盘点正常",console.log(this.items)):(this.$q.notify({type:"warning",position:"top",message:"盘盈"}),this.$http.post("takeStock/scanCode",{location_unique_code:this.positionCode,identity_code:this.deviceCode}).then((function(e){console.log(e),t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data),{},{check:"盘盈",active:!0}))})))},makeCheck:function(){var t=this;if(""!=this.items&&this.items!=[]){var e={location_unique_code:this.positionCode,identity_code:this.items.filter((function(t){return t.active})).map((function(t){return t.identity_code})),date:this.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")};console.log(e),this.$http.post("takeStock",e).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=[]})).catch((function(e){var a=e.response;console.log(a),t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))}else this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},Aa=Na,za=Object(d["a"])(Aa,Ea,Pa,!1,null,"0656ba8b",null),Ya=za.exports;v()(za,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QCardSection:et["a"]});var Ba=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addToList.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.addToList}})]},proxy:!0}]),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}})],1),a("br"),a("q-card",{staticStyle:{height:"calc(100vh - 215px)","overflow-y":"auto"}},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,showDelete:t.showD,slidable:!1}})],1)],1),t.$store.state.miniapp?a("div",{staticClass:"q-pt-md row"},[a("q-btn",{staticClass:"col",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描设备码"},on:{click:t.scanDevice}})],1):t._e(),t.showD?a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"unarchive",label:"出所"},on:{click:t.makeDepotOut}})],1):a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"mail",label:"出所"},on:{click:t.makeTaskDepotOut}})],1)],1)])},Wa=[],Ma=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{ref:"dialog",on:{hide:t.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("q-card-section",{staticClass:"row items-center q-pb-none"},[a("div",{staticClass:"text-h6"},[t._v("补充联系人信息")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"85%"}},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",disable:"",label:"经办人"},model:{value:t.$store.state.userInfo.nickname,callback:function(e){t.$set(t.$store.state.userInfo,"nickname",e)},expression:"$store.state.userInfo.nickname"}}),a("q-input",{attrs:{outlined:"",label:"联系人电话"},model:{value:t.contact.contact_phone,callback:function(e){t.$set(t.contact,"contact_phone",e)},expression:"contact.contact_phone"}})],1),t.contact.sign_img?a("q-img",{staticClass:"q-mt-md",staticStyle:{height:"200px"},attrs:{contain:"",src:t.contact.sign_img},on:{click:t.sign}}):a("q-btn",{staticClass:"q-mt-md full-width",attrs:{color:"primary",label:"电子签名"},on:{click:t.sign}})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"确认"},on:{click:t.onOKClick}}),a("q-btn",{attrs:{color:"info",label:"取消"},on:{click:t.onCancelClick}})],1)],1)],1)},Ha=[],Fa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{ref:"dialog",attrs:{maximized:""},on:{hide:t.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("q-card-section",{staticClass:"row items-center q-pb-none"},[a("div",{staticClass:"text-h6"},[t._v("电子签名")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),a("q-separator"),a("q-card-section",{staticStyle:{"max-height":"100%"}},[a("sign-canvas",{ref:"SignCanvas",staticClass:"sign-canvas sign-image",attrs:{options:t.options}})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"确认"},on:{click:t.onOKClick}}),a("q-btn",{attrs:{color:"primary",label:"取消"},on:{click:t.onCancelClick}})],1)],1)],1)},Ka=[],Ua=a("f4b0"),Va=a.n(Ua),Ja={name:"contact",components:{SignCanvas:Va.a},data:function(){return{options:{isDpr:!1,lastWriteSpeed:1,lastWriteWidth:2,lineCap:"round",lineJoin:"bevel",canvasWidth:320,canvasHeight:200,isShowBorder:!1,bgColor:"#F2F2F2",borderWidth:1,borderColor:"black",writeWidth:5,maxWriteWidth:30,minWriteWidth:5,writeColor:"#101010",isSign:!0,imgType:"png"}}},methods:{show:function(){this.$refs.dialog.show()},hide:function(){this.$refs.dialog.hide()},onDialogHide:function(){this.$emit("hide")},onOKClick:function(){var t=this.$refs.SignCanvas.saveAsImg();this.$emit("ok",t),this.hide()},onCancelClick:function(){this.hide()}}},Ga=Ja,Za=Object(d["a"])(Ga,Fa,Ka,!1,null,null,null),Xa=Za.exports;v()(Za,"components",{QDialog:Q["a"],QCard:O["a"],QCardSection:et["a"],QSpace:T["a"],QBtn:R["a"],QSeparator:at["a"],QCardActions:A["a"]}),v()(Za,"directives",{ClosePopup:it["a"]});var tn={name:"contact",data:function(){return{contact:{contact_name:"",contact_phone:"",sign_img:""}}},methods:{sign:function(){var t=this;this.$q.dialog({component:Xa,parent:this}).onOk((function(e){t.contact.sign_img=e})).onCancel((function(){console.log("Cancel")})).onDismiss((function(){console.log("Called on OK or Cancel")}))},show:function(){this.$refs.dialog.show()},hide:function(){this.$refs.dialog.hide()},onDialogHide:function(){this.$emit("hide")},onOKClick:function(){this.$emit("ok",Object(Ut["a"])({},this.contact)),this.hide()},onCancelClick:function(){this.hide()}}},en=tn,an=Object(d["a"])(en,Ma,Ha,!1,null,"2507f022",null),nn=an.exports;v()(an,"components",{QDialog:Q["a"],QCard:O["a"],QCardSection:et["a"],QSpace:T["a"],QBtn:R["a"],QSeparator:at["a"],QInput:nt["a"],QImg:E["a"],QCardActions:A["a"]}),v()(an,"directives",{ClosePopup:it["a"]});var on={components:{simpleList:Le},data:function(){return{items:[],active:!0,deviceCode:"",showD:!0}},created:function(){var t=this;this.$route.params.id&&(this.showD=!1,this.$http.post("workshopStayOutEntireInstances",{serial_number:this.$route.params.id}).then((function(e){var a=e.data.data;a.map((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.entire_instance),{},{active:!1}))}))})))},methods:{scanDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.deviceCode=a,t.addToList()}})},addToList:function(){var t=this;if(!1===this.showD){var e=this.items.find((function(e){return e.identity_code===t.deviceCode}));return console.log(e),void(e?(this.$q.notify({type:"positive",position:"top",message:"扫码成功"}),e.active=!0,this.deviceCode=""):this.$q.notify({type:"warning",position:"top",message:"不存在此设备"}))}if(""!=this.deviceCode){var a=this.items.map((function(t){return t.identity_code}));-1===a.indexOf(this.deviceCode)?(this.$http.post("workshopOutOfSearch",{data:this.deviceCode}).then((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data),{},{active:!1}))})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})})),this.deviceCode=""):this.$q.notify({type:"warning",position:"top",message:"此设备已经添加"})}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},makeDepotOut:function(){var t=this;""!=this.items&&this.items!=[]?this.$q.dialog({component:nn,parent:this}).onOk((function(e){console.log(">>>> OK, received",e);var a=Object(Ut["a"])(Object(Ut["a"])({datas:t.items.map((function(t){return t.identity_code}))},e),{},{date:t.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")});console.log(a),t.$http.post("workshopOut",a).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=[]})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))})):this.$q.notify({type:"warning",position:"top",message:"无设备"})},makeTaskDepotOut:function(){var t=this;""!=this.items&&this.items!=[]?this.$q.dialog({component:nn,parent:this}).onOk((function(e){console.log(">>>> OK, received",e);var a=Object(Ut["a"])(Object(Ut["a"])({serial_number:t.$route.params.id,identity_codes:t.items.filter((function(t){return t.active})).map((function(t){return t.identity_code}))},e),{},{date:t.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")});console.log(a),t.$http.post("passWorkshopOut",a).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=t.items.filter((function(t){return!t.active}))})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))})):this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},sn=on,cn=Object(d["a"])(sn,Ba,Wa,!1,null,"08ca8581",null),rn=cn.exports;v()(cn,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QScrollArea:na["a"],QCardSection:et["a"]});var ln=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addToList.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.addToList}})]},proxy:!0}]),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}})],1),a("br"),a("q-card",{staticStyle:{height:"calc(100vh - 215px)","overflow-y":"auto"}},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,slidable:!1}})],1)],1),t.$store.state.miniapp?a("div",{staticClass:"q-pt-md row"},[a("q-btn",{staticClass:"col",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描设备码"},on:{click:t.scanDevice}})],1):t._e(),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"move_to_inbox",label:"入所"},on:{click:t.makeDepotIn}})],1)],1)])},dn=[],un={components:{simpleList:Le},data:function(){return{items:[],active:!0,deviceCode:""}},methods:{scanDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.deviceCode=a,t.addToList()}})},addToList:function(){var t=this;if(""!=this.deviceCode){var e=this.items.map((function(t){return t.identity_code}));-1===e.indexOf(this.deviceCode)?(this.$http.post("workshopInOfSearch",{data:this.deviceCode}).then((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data),{},{active:!1}))})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})})),this.deviceCode=""):this.$q.notify({type:"warning",position:"top",message:"此设备已经添加"})}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},makeDepotIn:function(){var t=this;""!=this.items&&this.items!=[]?this.$q.dialog({component:nn,parent:this}).onOk((function(e){console.log(">>>> OK, received",e);var a=Object(Ut["a"])(Object(Ut["a"])({datas:t.items.map((function(t){return t.identity_code}))},e),{},{date:t.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")});console.log(a),t.$http.post("workshopIn",a).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=[]})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))})):this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},pn=un,mn=Object(d["a"])(pn,ln,dn,!1,null,"39da9609",null),hn=mn.exports;v()(mn,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QScrollArea:na["a"],QCardSection:et["a"]});var fn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{dense:"",disable:"direct"===t.mode,outlined:"",autocapitalize:"off",label:"上道设备/器材唯一编码",autofocus:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getNew.apply(null,arguments)}},model:{value:t.unique_code,callback:function(e){t.unique_code=e},expression:"unique_code"}}),a("q-input",{ref:"level",attrs:{dense:"",outlined:"",autocapitalize:"off",label:"上道位置层编码"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getPosition.apply(null,arguments)}},model:{value:t.levelCode,callback:function(e){t.levelCode=e},expression:"levelCode"}}),a("device",{attrs:{item:t.newdevice}}),a("position",{attrs:{position:t.position_detail},on:{positionChange:t.test}}),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"file_upload",label:"上道"},on:{click:t.makeInstall}})],1)],1)])},vn=[],_n={components:{Device:ma,position:ba},data:function(){return{shape:"line",mode:"cycle",install:{new_identity_code:"",old_identity_code:"",maintain_location_code:""},unique_code:"",olddevice:{},newdevice:{},levelCode:"",position_detail:{},position:""}},methods:{test:function(t){this.position=t},makeInstall:function(){var t=this,e={status:"INSTALLED",date:this.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss"),maintain_location_code:this.position};this.$http.post("inDoorInstalledStrictAndInstalling/".concat(this.unique_code),e).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg})})).catch((function(e){var a=e.response;console.log(a),t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))},getNew:function(){var t=this;this.$http.get("installed",{params:{code:this.unique_code}}).then((function(e){t.newdevice=e.data.data[0],t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.$refs.level.focus()})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))},getPosition:function(){var t=this;this.$http.get("installPosition/byInstallTierUniqueCode/".concat(this.levelCode)).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.position_detail=Object(Ut["a"])(Object(Ut["a"])({},e.data.data),{},{install_tier_unique_code:t.levelCode})})).catch(this.$n_error)}}},gn=_n,bn=Object(d["a"])(gn,fn,vn,!1,null,"16afc417",null),yn=bn.exports;v()(bn,"components",{QInput:nt["a"],QBtn:R["a"]});var qn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md"},[a("div",{},[a("div",{staticClass:"q-gutter-md",staticStyle:{height:"calc(100vh - 125px)"}},[a("q-btn-toggle",{attrs:{spread:"","no-caps":"","toggle-color":"blue",color:"white","text-color":"black",options:[{label:"室内上道",value:"in"},{label:"室外上道",value:"out"}]},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}}),a("q-input",{attrs:{dense:"",outlined:"",autocapitalize:"off",label:"待上道设备编号"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getNew.apply(null,arguments)}},model:{value:t.install.identity_code,callback:function(e){t.$set(t.install,"identity_code",e)},expression:"install.identity_code"}}),a("stations",{on:{station:function(e){t.install.station_unique_code=e.unique_code}}}),"in"==t.mode?a("q-input",{attrs:{dense:"",outlined:"",autocapitalize:"off",label:"组合位置"},model:{value:t.install.maintain_location_code,callback:function(e){t.$set(t.install,"maintain_location_code",e)},expression:"install.maintain_location_code"}}):t._e(),"out"==t.mode?a("q-input",{attrs:{dense:"",outlined:"",autocapitalize:"off",label:"道岔号"},model:{value:t.install.crossroad_number,callback:function(e){t.$set(t.install,"crossroad_number",e)},expression:"install.crossroad_number"}}):t._e(),"out"==t.mode?a("q-select",{attrs:{dense:"","options-dense":"",outlined:"",label:"开向",options:t.options,"emit-value":"","map-options":""},model:{value:t.install.open_direction,callback:function(e){t.$set(t.install,"open_direction",e)},expression:"install.open_direction"}}):t._e(),a("device",{attrs:{type:"new",item:t.newdevice}})],1),a("div",{staticClass:"q-pt-none column"},[a("q-btn",{attrs:{color:"primary",icon:"file_upload",label:"上道"},on:{click:t.makeInstall}})],1)])])},kn=[],Cn={components:{Device:ma,stations:ae},data:function(){return{shape:"line",mode:"in",install:{identity_code:"",maintain_location_code:"",crossroad_number:"",open_direction:"",station_unique_code:""},olddevice:{},newdevice:{},group:"op1",direction:"",options:[{label:"左",value:"left"},{label:"右",value:"right"},{label:"无",value:"none"}]}},watch:{mode:function(){this.install.maintain_location_code="",this.install.crossroad_number=""}},methods:{scanOldDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.install.old_identity_code=a,t.getOld()}})},scanNewDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.install.new_identity_code=a,t.getNew()}})},makeInstall:function(){var t=this,e=Object(Ut["a"])({date:this.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")},this.install);this.$http.post("outDoorInstalledUnStrictAndInDoorInstalledStrict/".concat(this.install.identity_code),e).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg})})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))},getOld:function(){var t=this;this.$http.get("installed",{params:{code:this.install.identity_code}}).then((function(e){0!==e.data.data.length?(t.olddevice=e.data.data[0],t.install.old_identity_code=""):t.$q.notify({type:"warning",position:"top",message:"设备不存在"})}))},getNew:function(){var t=this;this.$http.get("installed",{params:{code:this.install.identity_code}}).then((function(e){0!==e.data.data.length?(t.newdevice=e.data.data[0],t.install.new_identity_code=""):t.$q.notify({type:"warning",position:"top",message:"设备不存在"})}))}}},wn=Cn,$n=a("6a67"),xn=Object(d["a"])(wn,qn,kn,!1,null,"d0b81320",null),Qn=xn.exports;v()(xn,"components",{QBtnToggle:$n["a"],QInput:nt["a"],QSelect:te["a"],QBtn:R["a"]});var On=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addToList.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.addToList}})]},proxy:!0}]),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}})],1),a("br"),a("q-card",{staticStyle:{height:"calc(100vh - 215px)","overflow-y":"auto"}},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,slidable:!1}})],1)],1),t.$store.state.miniapp?a("div",{staticClass:"q-pt-md row"},[a("q-btn",{staticClass:"col",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描设备码"},on:{click:t.scanDevice}})],1):t._e(),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"get_app",label:"下道"},on:{click:t.makeUninstall}})],1)],1)])},Sn=[],Dn={components:{simpleList:Le},data:function(){return{items:[],active:!0,deviceCode:""}},methods:{scanDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.deviceCode=a,t.addToList()}})},addToList:function(){var t=this;if(""!=this.deviceCode){var e=this.items.map((function(t){return t.identity_code}));console.log(e),-1===e.indexOf(this.deviceCode)?this.$http.get("uninstall",{params:{code:this.deviceCode}}).then((function(e){0!==e.data.data.length?(t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data[0]),{},{active:!1})),t.deviceCode=""):t.$q.notify({message:"设备不存在",position:"top",type:"warning"})})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})})):this.$q.notify({type:"warning",position:"top",message:"此设备已经添加"})}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},makeUninstall:function(){var t=this;if(0!==this.items.length){var e={identity_codes:this.items.map((function(t){return t.identity_code})),date:this.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")};this.$http.post("uninstall",e).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=[]})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))}else this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},Ln=Dn,jn=Object(d["a"])(Ln,On,Sn,!1,null,"207e63c7",null),In=jn.exports;v()(jn,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QScrollArea:na["a"],QCardSection:et["a"]});var Tn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{dense:"",outlined:"",label:"设备唯一码"},scopedSlots:t._u([{key:"append",fn:function(){return[t.$store.state.miniapp?t._e():a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"center_focus_weak"},on:{click:function(e){return t.showQR("instance")}}})]},proxy:!0}]),model:{value:t.entire_instance_identity_code,callback:function(e){t.entire_instance_identity_code=e},expression:"entire_instance_identity_code"}}),a("q-input",{attrs:{dense:"",outlined:"",label:"位置码"},scopedSlots:t._u([{key:"append",fn:function(){return[t.$store.state.miniapp?t._e():a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"center_focus_weak"},on:{click:function(e){return t.showQR("loc")}}})]},proxy:!0}]),model:{value:t.maintain_location_code,callback:function(e){t.maintain_location_code=e},expression:"maintain_location_code"}}),a("q-card",{staticStyle:{height:"calc(100vh - 300px)","overflow-y":"auto"}},[a("q-card-section",[a("q-list",{directives:[{name:"show",rawName:"v-show",value:0==!t.histories.length,expression:"!histories.length == 0"}],attrs:{bordered:"",separator:""}},t._l(t.histories,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,attrs:{clickable:""},on:{click:function(a){return t.showDetail(e.entire_instance_identity_code)}}},[a("q-item-section",{staticClass:"text-caption"},[t._v(" "+t._s(e.entire_instance_identity_code)+" "),a("q-item-label",[t._v("车站："+t._s(e.maintain_station_name))])],1),a("q-item-section",{staticClass:"text-caption",attrs:{avatar:""}},[t._v(" 安装位置："+t._s(e.maintain_location_code)+" "),a("q-item-label",{staticClass:"text-grey"},[t._v(t._s(e.updated_at))])],1)],1)})),1)],1)],1),t.$store.state.miniapp?a("div",{staticClass:"row"},[a("q-btn",{staticClass:"col",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描位置码"},on:{click:t.scanLoc}}),a("q-btn",{staticClass:"col q-ml-sm",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描设备码"},on:{click:t.scanDevice}})],1):t._e(),a("div",{staticClass:"column"},[a("q-btn",{attrs:{color:"primary",icon:"share_location",label:"设备定位"},on:{click:t.makeLoc}})],1)],1)])])},Rn=[],En={components:{},data:function(){return{histories:[{id:1,name:"aaa"}],entire_instance_identity_code:"",maintain_location_code:"",station:""}},created:function(){var t=this;this.$http.get("stationInstallLocationRecords").then((function(e){t.histories=e.data.data.station_install_location_records}))},methods:{scanLoc:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.maintain_location_code=a}})},scanDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.entire_instance_identity_code=a}})},handleStation:function(t){console.log(t.name),this.station=t.name},makeLoc:function(){var t=this;this.entire_instance_identity_code&&this.maintain_location_code&&this.$http.post("correctMaintainLocation",{entire_instance_identity_code:this.entire_instance_identity_code,maintain_station_name:this.station,maintain_location_code:this.maintain_location_code}).then((function(e){return t.$q.notify({position:"top",message:e.data.msg,type:"positive"}),t.entire_instance_identity_code="",t.maintain_location_code="",t.$http.get("stationInstallLocationRecords")})).then((function(e){t.histories=e.data.data.station_install_location_records})).catch(this.$n_error)},showDetail:function(t){this.$q.dialog({component:Y,parent:this,ucode:t}).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}))},showQR:function(t){var e=this;this.$q.dialog({component:K,parent:this}).onOk((function(a){"instance"===t?e.entire_instance_identity_code=a:e.maintain_location_code=a}))}}},Pn=En,Nn=Object(d["a"])(Pn,Tn,Rn,!1,null,"3ee755f0",null),An=Nn.exports;v()(Nn,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QCardSection:et["a"],QList:$e["a"],QItem:I["a"],QItemSection:Qe["a"],QItemLabel:Oe["a"]}),v()(Nn,"directives",{Ripple:Se["a"]});var zn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("printer"),a("print",{attrs:{items:t.ll}}),a("q-input",{attrs:{label:"搜索"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.test.apply(null,arguments)}},model:{value:t.searchData,callback:function(e){t.searchData=e},expression:"searchData"}}),a("q-input",{attrs:{label:"搜索列表"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.test2.apply(null,arguments)}},model:{value:t.searchList,callback:function(e){t.searchList=e},expression:"searchList"}}),a("q-btn",{attrs:{label:"test"},on:{click:t.test}}),a("q-btn",{attrs:{label:"签名"},on:{click:t.haha}}),a("q-btn",{attrs:{label:"测试微信"},on:{click:t.test_wechat}}),a("Stations"),a("station"),a("workareas",{on:{workarea:t.handleWorkarea}}),a("ranks"),a("model"),a("location"),a("sign-canvas",{ref:"SignCanvas",staticClass:"sign-canvas"})],1)},Yn=[],Bn=(a("a15b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.imgUrl?a("img",{attrs:{src:t.imgUrl,alt:"分享图片"}}):a("div",{ref:"box",attrs:{id:"qrcode"}},[a("div",{staticClass:"text-h6"},[t._v(t._s(t.qrcode_content))])]),a("canvas",{ref:"can",attrs:{height:"80",width:"200"}}),a("q-btn",{attrs:{label:"print"},on:{click:t.generateImg}})],1)}),Wn=[],Mn=a("f2e5"),Hn={data:function(){return{imgUrl:"",qrcode_content:"Q040"}},mounted:function(){var t=this;t.appSrc="www.baicu.com",t.$nextTick((function(){this.$refs.can=Object(Mn["a"])({data:decodeURIComponent(t.qrcode_content),size:80})}))},methods:{generateImg:function(){var t=this;setTimeout((function(){var e=t.$refs.can.toDataURL("image/png");window.AndroidWebView.Printing(35,20,1,0,0,2.1,e.split(",")[1])}),0)}}},Fn=Hn,Kn=Object(d["a"])(Fn,Bn,Wn,!1,null,null,null),Un=Kn.exports;v()(Kn,"components",{QBtn:R["a"]});var Vn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-list",{attrs:{bordered:"",separator:""}},t._l(t.printlist,(function(e,n){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,attrs:{clickable:""},on:{click:function(a){return t.showDetail(e.identity_code)}}},[a("q-item-section",[t._v(" "+t._s(e.identity_code)+" "+t._s(e.category_name)+" "+t._s(e.model_name)+" "+t._s(e.made_at.split(" ")[0])+" ")])],1)})),1)],1)},Jn=[],Gn={name:"print",props:["items"],computed:{printlist:function(){return this.items}},data:function(){return{}},methods:{showDetail:function(t){this.$q.dialog({component:Y,parent:this,ucode:t}).onOk((function(){console.log("OK")})).onCancel((function(){console.log("Cancel")})).onDismiss((function(){console.log("Called on OK or Cancel")}))}}},Zn=Gn,Xn=Object(d["a"])(Zn,Vn,Jn,!1,null,"0432b082",null),ti=Xn.exports;v()(Xn,"components",{QList:$e["a"],QItem:I["a"],QItemSection:Qe["a"]}),v()(Xn,"directives",{Ripple:Se["a"]});var ei=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-tree",{attrs:{nodes:t.stations,"node-key":"unique_code","label-key":"name","children-key":"subset",selected:t.selected,"default-expand-all":""},on:{"update:selected":[t.selectaaa,function(e){t.selected=e}]}})],1)},ai=[],ni={name:"station",data:function(){return{stations:[],selected:""}},mounted:function(){this.loadStations()},methods:{selectaaa:function(t){console.log(t)},loadStations:function(){var t=this,e=this.$q.notify({type:"ongoing",message:"正在获取车站数据...",position:"top"});this.$http.get("maintains").then((function(a){t.stations=a.data.data,e({message:"获取车站信息成功",position:"top",type:"positive"})})).catch((function(t){var a=t.response;e({message:a.data.msg,position:"top",type:"warning"})}))}}},ii=ni,oi=Object(d["a"])(ii,ei,ai,!1,null,"512dace6",null),si=oi.exports;v()(oi,"components",{QTree:Ee["a"]});var ci={components:{SignCanvas:Va.a,printer:Un,Station:si,Stations:ae,Model:Me,Location:Ne,print:ti,workareas:re,ranks:he},data:function(){return{searchData:"Q010101B04900000001",searchList:"maintain_station_name,田心东站（城）",ll:[]}},methods:{haha:function(){this.$q.dialog({component:Xa,parent:this}).onOk((function(t){console.log("OK",t)})).onCancel((function(){console.log("Cancel")})).onDismiss((function(){console.log("Called on OK or Cancel")}))},handleWorkshop:function(t){console.log(t.name),this.station=t.name},handleStation:function(t){console.log(t.name),this.station=t.name},handleWorkarea:function(t){console.log(t)},test_wechat:function(){var t=this;this.$http.get("https://test.hefei.zhongchengkeshi.com/api/wechatMiniApp/jsApiSignature?url=".concat(location.href.split("#")[0])).then((function(e){var a=e.data.data,n=a.noncestr,i=a.timestamp,o=a.signature,s=a.app_id;t.$wx.config({debug:!0,appId:s,timestamp:i,nonceStr:n,signature:o,jsApiList:["scanQRCode"]})})),this.$q.notify({position:"top",type:"positive",message:JSON.stringify({res:"aaa"})}),this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){t.$q.notify({position:"top",type:"positive",message:JSON.stringify(e)})}})},test2:function(){var t=this,e=this.searchList.split(",").join("=");this.$http.get("entireInstances?".concat(e)).then((function(e){t.ll=e.data.data.entire_instances}))},test:function(){var t=this.searchData;this.$q.dialog({component:Y,parent:this,ucode:t}).onOk((function(){console.log("OK")})).onCancel((function(){console.log("Cancel")})).onDismiss((function(){console.log("Called on OK or Cancel")}))}}},ri=ci,li=Object(d["a"])(ri,zn,Yn,!1,null,"3646c00c",null),di=li.exports;v()(li,"components",{QInput:nt["a"],QBtn:R["a"]});var ui=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",[a("q-card",{staticStyle:{height:"calc(100vh - 130px)","overflow-y":"auto"}},[a("q-card-section",[a("q-list",{directives:[{name:"show",rawName:"v-show",value:0==!t.tasks.length,expression:"!tasks.length == 0"}],attrs:{bordered:"",separator:""}},t._l(t.tasks,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,attrs:{clickable:""},on:{click:function(a){return t.navTask(e.serial_number)}}},[a("q-item-section",[t._v(" "+t._s(e.serial_number)+" "),a("q-item-label",[t._v(" "+t._s(e.scene_workshop.name)+" "+t._s(e.maintain_station.name)+" "+t._s(e.work_area_by_unique_code.name)+" ")]),a("q-item-label")],1),a("q-item-section",{attrs:{avatar:""}},[t._v(t._s(e.status.name))])],1)})),1)],1)],1)],1)])])},pi=[],mi={components:{},data:function(){return{tasks:[],deviceCode:""}},created:function(){var t=this;this.$http.post("taskList",{type:"NEW_STATION"}).then((function(e){t.tasks=e.data.data.data}))},methods:{navTask:function(t){console.log(t),this.$router.push({path:"/task/list/".concat(t)})}}},hi=mi,fi=Object(d["a"])(hi,ui,pi,!1,null,"eac71bc4",null),vi=fi.exports;v()(fi,"components",{QCard:O["a"],QCardSection:et["a"],QList:$e["a"],QItem:I["a"],QItemSection:Qe["a"],QItemLabel:Oe["a"]}),v()(fi,"directives",{Ripple:Se["a"]});var _i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},["SceneWorkAreaCrew"===t.userRank?a("div",[a("q-card",{staticStyle:{height:"calc(100vh - 95px)","overflow-y":"auto"}},[a("q-card-section",[a("div",{staticClass:"col q-mb-sm"},[a("div",{staticClass:"text-subtitle2"},[t._v("待完成任务列表")])]),a("q-list",{directives:[{name:"show",rawName:"v-show",value:0==!t.data.length,expression:"!data.length == 0"}],attrs:{bordered:"",separator:""}},t._l(t.data,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,attrs:{clickable:""},on:{click:function(a){return t.navTask(e.serial_number)}}},[a("q-item-section",[t._v(" "+t._s(e.with_check_plan.with_check_project.name)+" "),a("q-item-label",[t._v(" "+t._s(e.principal_id_level5.nickname)+" "+t._s(e.expiring_at.split(" ")[0]))]),a("q-item-label")],1)],1)})),1)],1)],1)],1):a("div",[a("q-table",{staticClass:"statstable",style:"SceneWorkshopPrincipal"===t.userRank?"height: calc(100vh - 145px)":"height: calc(100vh - 100px)",attrs:{data:t.data,visibleColumns:t.visibleColumns,columns:t.columns,"row-key":"name","binary-state-sort":"",pagination:{rowsPerPage:20},"hide-bottom":""},scopedSlots:t._u([{key:"top",fn:function(){return[a("div",{staticClass:"col q-table__title"},[t._v("年月表计划")]),a("q-space"),a("q-select",{attrs:{outlined:"",dense:"","options-dense":"",label:"月份",options:t.month},model:{value:t.selectedMonth,callback:function(e){t.selectedMonth=e},expression:"selectedMonth"}})]},proxy:!0},{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{key:"project",style:{width:"400px",whiteSpace:"normal"},attrs:{props:e}},[t._v(" "+t._s(e.row.with_check_project.name)+" ")]),a("q-td",{key:"maintain_station_unique_code",attrs:{props:e}},[t._v(" "+t._s(e.row.with_station.name)+" ")]),a("q-td",{key:"number",attrs:{props:e}},[t._v(" "+t._s(e.row.number)+" ")]),a("q-td",{key:"code",attrs:{props:e}},[0!==e.row.count?a("q-btn",{attrs:{flat:"",round:"",icon:"fact_check",size:"sm"},on:{click:function(a){return t.check(e.row.serial_number,e.row)}}}):t._e()],1)],1)]}}])}),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{directives:[{name:"show",rawName:"v-show",value:"SceneWorkshopPrincipal"===t.userRank,expression:"userRank === 'SceneWorkshopPrincipal'"}],attrs:{color:"primary",icon:"assignment",label:"创建临时任务"},on:{click:t.createTask}})],1)],1)])])},gi=[],bi={components:{},data:function(){return{month:["2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12"],selectedMonth:"2021-05",visibleColumns:["project","maintain_station_unique_code","number","code"],columns:[{name:"project",label:"任务名称",align:"left",field:"project"},{name:"maintain_station_unique_code",label:"车站",align:"left",field:"maintain_station_unique_code"},{name:"number",align:"center",label:"计划设备数",field:"number"},{name:"code",align:"center",label:"分配",field:"code"}],data:[],tasks:[],deviceCode:"",userRank:""}},created:function(){var t=this,e=localStorage.getItem("token");this.userRank=k.a.decode(e).payload.rank.code;var a=k.a.decode(e).payload.id;"SceneWorkAreaCrew"===this.userRank?this.$http.get("taskStationCheckOrder?status=UNDONE&principal_id_level_5=".concat(a)).then((function(e){t.data=e.data.data.task_station_check_orders})):this.$http.get("checkPlan").then((function(e){t.data=e.data.data.check_plans}))},methods:{navTask:function(t){console.log(t),this.$router.push({path:"/scenetask/check/".concat(t)})},createTask:function(){this.$router.push({path:"/scenetask/edit"})},check:function(t,e){console.log(e),3!==e.status.value?1!==e.status.value?0!==e.number?this.$router.push({path:"/scenetask/edit/".concat(t)}):this.$q.notify({position:"top",type:"warning",message:"计划没有分配设备"}):this.$q.notify({position:"top",type:"warning",message:"任务已结束"}):this.$q.notify({position:"top",type:"warning",message:"任务已分配完成"})}}},yi=bi,qi=(a("d962"),a("bd08")),ki=a("db86"),Ci=Object(d["a"])(yi,_i,gi,!1,null,null,null),wi=Ci.exports;v()(Ci,"components",{QCard:O["a"],QCardSection:et["a"],QList:$e["a"],QItem:I["a"],QItemSection:Qe["a"],QItemLabel:Oe["a"],QTable:Rt["a"],QSpace:T["a"],QSelect:te["a"],QTr:qi["a"],QTd:ki["a"],QBtn:R["a"]}),v()(Ci,"directives",{Ripple:Se["a"]});var $i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-9",attrs:{disable:!t.is_tmptask,label:"任务名称",dense:"",outlined:""},model:{value:t.task_name,callback:function(e){t.task_name=e},expression:"task_name"}}),a("q-input",{staticClass:"col q-ml-xs",attrs:{disable:!t.is_tmptask,label:"单位",dense:"",outlined:""},model:{value:t.unit,callback:function(e){t.unit=e},expression:"unit"}})],1),a("q-select",{staticClass:"q-mt-sm",attrs:{dense:"",outlined:"",disable:!t.is_tmptask,options:t.stations,"map-options":"","options-dense":"","option-value":"unique_code","option-label":"name",label:"选择车站","emit-value":""},model:{value:t.station,callback:function(e){t.station=e},expression:"station"}}),a("q-input",{staticClass:"q-mt-sm",attrs:{dense:"",outlined:"",label:"选择任务日期",mask:"date"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:t.date,callback:function(e){t.date=e},expression:"date"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"确认",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),a("div",{staticClass:"q-mt-sm row"},[a("q-select",{staticClass:"col",attrs:{loading:t.loading_lv5s,dense:"",outlined:"",options:t.lv5s,"map-options":"","options-dense":"","option-value":"id","option-label":"nickname",label:"选择现场职工","emit-value":""},model:{value:t.lv5,callback:function(e){t.lv5=e},expression:"lv5"}})],1),a("q-card",{staticClass:"q-my-md",staticStyle:{"overflow-y":"auto",height:"calc(100vh - 345px)"}},[a("q-card-section",[0!==t.items.length?a("q-list",t._l(t.items,(function(e,n){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,attrs:{dense:""}},[a("q-item-section",{attrs:{side:"",top:""}},[a("q-checkbox",{model:{value:e.checked,callback:function(a){t.$set(e,"checked",a)},expression:"item.checked"}})],1),a("q-item-section",[t._v(" "+t._s(e.maintain_location_code)+t._s(e.crossroad_number)+" "),a("q-item-label",[t._v(t._s(e.identity_code))]),a("q-item-label",[t._v(" "+t._s(e.category_name)+" "+t._s(e.model_name)+" "+t._s(e.sub_model_name)+" ")])],1)],1)})),1):a("div",{staticClass:"q-pt-sm column"},[a("q-btn",{attrs:{color:"primary",icon:"add",disable:""==t.station,label:""!=t.station?"添加":"选择车站后添加设备"},on:{click:function(e){t.showParams=!0}}})],1)],1)],1),a("div",{staticClass:"q-pt-sm column"},[a("q-btn",{attrs:{color:"primary",icon:"fact_check",label:"分配任务"},on:{click:t.makeArrange}})],1),a("q-dialog",{attrs:{"full-height":"","full-width":""},model:{value:t.showParams,callback:function(e){t.showParams=e},expression:"showParams"}},[a("q-card",[a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"添加",color:"primary"},on:{click:t.addDevice}})],1),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticClass:"row"},t._l(t.crossroads,(function(e){return a("q-checkbox",{key:e.name,staticClass:"q-pt-sm col-4",attrs:{flat:"",val:e.name,label:e.name},model:{value:t.selected_crossroad,callback:function(e){t.selected_crossroad=e},expression:"selected_crossroad"}})})),1)])],1)],1)],1)},xi=[],Qi=a("3835"),Oi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{ref:"dialog",on:{hide:t.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("q-card-section",{staticClass:"row items-center q-pb-none"},[a("div",{staticClass:"text-h6"},[t._v("添加车站")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"85%"}},[a("div",{staticClass:"q-gutter-md"},[a("q-select",{attrs:{dense:"",outlined:"",options:t.stations,"map-options":"","options-dense":"","option-value":"unique_code","option-label":"name",label:"选择车站","emit-value":""},model:{value:t.station,callback:function(e){t.station=e},expression:"station"}})],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"确认"},on:{click:t.onOKClick}}),a("q-btn",{attrs:{color:"primary",label:"取消"},on:{click:t.onCancelClick}})],1)],1)],1)},Si=[],Di={name:"config",data:function(){return{stations:[],station:""}},methods:{show:function(){var t=this,e=this.$store.state.userInfo.workshop_unique_code;this.$http.get("stations",{params:{type:"STATION",parent_unique_code:e}}).then((function(e){t.stations=e.data.data.stations,t.$refs.dialog.show()})),this.$refs.dialog.show()},hide:function(){this.$refs.dialog.hide()},onDialogHide:function(){this.$emit("hide")},onOKClick:function(){var t=this,e=this.stations.find((function(e){return e.unique_code===t.station}));this.$emit("ok",e),this.hide()},onCancelClick:function(){this.hide()}}},Li=Di,ji=Object(d["a"])(Li,Oi,Si,!1,null,"4c406768",null),Ii=ji.exports;v()(ji,"components",{QDialog:Q["a"],QCard:O["a"],QCardSection:et["a"],QSpace:T["a"],QBtn:R["a"],QSeparator:at["a"],QSelect:te["a"],QCardActions:A["a"]}),v()(ji,"directives",{ClosePopup:it["a"]});var Ti={data:function(){return{is_tmptask:!0,search_category_unique_code:"",search_entire_model_unique_code:"",search_model_unique_code:"",user_workshop:"",loading_lv5s:!0,showParams:!1,station:"",stations:[],items:[],lv5:"",lv5s:[],date:"",task_name:"",unit:"",crossroads:[],selected_crossroad:[],columns:[{name:"station_name",label:"车站名称",align:"left",field:"station_name"},{name:"number",align:"center",label:"数量（点击可编辑）",field:"number"}],data:[]}},created:function(){var t=this;this.$route.params.id&&(this.is_tmptask=!1,this.$http.get("checkPlan/".concat(this.$route.params.id)).then((function(e){console.log(e.data.data.check_plan),t.task_name=e.data.data.check_plan.with_check_project.name,t.unit=e.data.data.check_plan.unit,t.station=e.data.data.check_plan.with_station.name,t.items=e.data.data.check_plan.check_plan_entire_instances.filter((function(t){return 0===t.is_use})).map((function(t){return Object(Ut["a"])(Object(Ut["a"])({},t.entire_instance),{},{checked:!1})}))}))),this.user_workshop=this.$store.state.userInfo.workshop_unique_code,this.$http.get("stations",{params:{type:"STATION",parent_unique_code:this.user_workshop}}).then((function(e){t.stations=e.data.data.stations})),this.$http.get("accounts?rank=SceneWorkAreaCrew&workshop_unique_code=".concat(this.user_workshop)).then((function(e){t.lv5s=e.data.data.accounts,t.loading_lv5s=!1}))},watch:{station:function(t){var e=this,a=this.stations.find((function(e){return e.unique_code===t})).name;this.$http.get("entireInstanceForCreateTaskStationCheckOrder?maintain_station_name=".concat(a)).then((function(t){e.crossroads=Object.entries(t.data.data.entire_instances).map((function(t){var e=Object(Qi["a"])(t,2),a=e[0],n=e[1];return{name:a,data:n}}))}))}},methods:{addDevice:function(){var t=this,e=[];this.selected_crossroad.map((function(a){e.push.apply(e,Object(Gt["a"])(t.crossroads.find((function(t){return t.name==a})).data))})),this.items=e.map((function(t){return Object(Ut["a"])(Object(Ut["a"])({},t),{},{checked:!1})}))},addStation:function(){var t=this;this.$q.dialog({component:Ii,parent:this}).onOk((function(e){var a=e.unique_code,n=e.name;t.data.some((function(t){return t.unique_code===a}))?t.$q.notify({message:"车站已添加",position:"top",type:"warning"}):t.data.push({unique_code:a,station_name:n,number:0})}))},handleModel:function(t){this.search_category_unique_code=t.category_unique_code,this.search_entire_model_unique_code=t.entire_model_unique_code,this.search_model_unique_code=t.model_unique_code},makeArrange:function(){var t=this,e=this.items.filter((function(t){return t.checked})).map((function(t){return t.identity_code})),a={};this.is_tmptask?a["station_unique_code"]=this.station:a["check_plan_serial_number"]=this.$route.params.id,a["principal_id_5"]=1*this.lv5,a["expiring_at"]=this.date.split("/").join("-"),a["unit"]=this.unit,a["project"]=this.task_name,a["identity_codes"]=e,this.$http.post("taskStationCheckOrder",Object(Ut["a"])({},a)).then((function(e){t.$n_success(e),t.$route.params.id&&(t.is_tmptask=!1,t.$http.get("checkPlan/".concat(t.$route.params.id)).then((function(e){console.log(e.data.data.check_plan),t.task_name=e.data.data.check_plan.with_check_project.name,t.unit=e.data.data.check_plan.unit,t.station=e.data.data.check_plan.with_station.name,t.items=e.data.data.check_plan.check_plan_entire_instances.filter((function(t){return 0===t.is_use})).map((function(t){return Object(Ut["a"])(Object(Ut["a"])({},t.entire_instance),{},{checked:!1})}))})))})).catch(this.$n_error)}}},Ri=Ti,Ei=(a("2884"),a("7cbe")),Pi=a("52ee"),Ni=a("8f8e"),Ai=Object(d["a"])(Ri,$i,xi,!1,null,null,null),zi=Ai.exports;v()(Ai,"components",{QInput:nt["a"],QSelect:te["a"],QIcon:pt["a"],QPopupProxy:Ei["a"],QDate:Pi["a"],QBtn:R["a"],QCard:O["a"],QCardSection:et["a"],QList:$e["a"],QItem:I["a"],QItemSection:Qe["a"],QCheckbox:Ni["a"],QItemLabel:Oe["a"],QDialog:Q["a"],QCardActions:A["a"],QTable:Rt["a"]}),v()(Ai,"directives",{ClosePopup:it["a"],Ripple:Se["a"]});var Yi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md"},[a("q-card",{attrs:{flat:"",bordered:""}},[a("q-card-section",{staticClass:"text-h6",staticStyle:{height:"64px"}},[t._v(" "+t._s(t.taskDetail.with_check_plan.with_check_project.name)+" "+t._s(t.taskDetail.expiring_at.split(" ")[0])+" ")]),a("q-card-section",[a("div",{staticClass:"text-grey"},[t._v("任务进度")]),a("q-linear-progress",{staticClass:"q-mt-md",attrs:{size:"40px",value:t.progress,color:"green"}},[a("div",{staticClass:"absolute-full flex flex-center"},[a("q-badge",{attrs:{color:"white","text-color":"blue",label:t.taskDetail.task_station_check_entire_instances_count+"/"+t.taskDetail.number}})],1)])],1)],1),a("q-card",{staticClass:"q-mt-md",style:"overflow-y: auto;"+("SceneWorkAreaCrew"===t.userRank?"height: calc(100vh - 325px)":"height: calc(100vh - 285px)")},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,showDelete:!1,showCrossroad:!0,slidable:!1},on:{delete:t.handleDelete}})],1)],1),"SceneWorkAreaCrew"===t.userRank?a("div",{staticClass:"q-pt-md row"},[a("q-btn",{staticClass:"col",attrs:{color:"primary",icon:"center_focus_weak",label:"扫描设备码"},on:{click:t.scanDevice}})],1):t._e()],1)},Bi=[],Wi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{ref:"dialog",attrs:{persistent:""},on:{hide:t.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("div",{staticClass:"q-pa-none row"}),a("q-card-actions",{attrs:{align:"center"}},[a("q-btn",{attrs:{color:"primary",label:"选择照片"},on:{click:t.onOKClick}}),a("q-btn",{attrs:{color:"primary",label:"直接提交"},on:{click:t.onCancelClick}})],1)],1)],1)},Mi=[],Hi={name:"config",data:function(){return{stations:[],station:"",filesImages:null}},methods:{onRejected:function(t){this.$q.notify({type:"negative",message:"".concat(t.length," file(s) did not pass validation constraints")})},show:function(){this.$refs.dialog.show()},upload:function(){},hide:function(){this.$refs.dialog.hide()},onDialogHide:function(){this.$emit("hide")},onOKClick:function(){var t=this;console.log("aaaa"),this.$wx.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var a=e.localIds[0];t.$wx.getLocalImgData({localId:a,success:function(e){var a=e.localData;console.log(a),t.$emit("ok",a),t.hide()}})}})},onCancelClick:function(){this.hide()}}},Fi=Hi,Ki=a("7d53"),Ui=a("ee89"),Vi=Object(d["a"])(Fi,Wi,Mi,!1,null,"4a0b89ab",null),Ji=Vi.exports;v()(Vi,"components",{QDialog:Q["a"],QCard:O["a"],QCardSection:et["a"],QSpace:T["a"],QBtn:R["a"],QSeparator:at["a"],QFile:Ki["a"],QUploader:Ui["a"],QCardActions:A["a"]}),v()(Vi,"directives",{ClosePopup:it["a"]});var Gi={components:{simpleList:Le},data:function(){return{userRank:"",deviceCode:"",progress:0,taskDetail:{},items:[]}},created:function(){var t=this;return Object(J["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.init_data();case 2:a=localStorage.getItem("token"),t.userRank=k.a.decode(a).payload.rank.code;case 4:case"end":return e.stop()}}),e)})))()},methods:{handleDelete:function(t){var e=this;console.log(t),this.$http.delete("taskStationCheckEntireInstance/".concat(this.$route.params.id),{data:{entire_instance_identity_code:t}}).then((function(t){e.$n_success(t),e.init_data()})).catch(this.$n_error)},scanDevice:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.deviceCode=a,t.addToList()}})},addToList:function(){var t=this;if(""!=this.deviceCode){console.log(this.items);var e=this.items.find((function(e){return e.identity_code===t.deviceCode}));if(!e)return void this.$q.notify({message:"设备未找到",position:"top",type:"warning"});this.$q.dialog({component:Ji,parent:this}).onOk((function(e){console.log(JSON.stringify([e])),t.$http.post("taskStationCheckEntireInstance/".concat(t.$route.params.id),{entire_instance_identity_code:t.deviceCode,images:JSON.stringify([e])}).then((function(e){t.$n_success(e),t.init_data(),t.deviceCode=""})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))})).onCancel((function(){console.log("bbbb"),t.$http.post("taskStationCheckEntireInstance/".concat(t.$route.params.id),{entire_instance_identity_code:t.deviceCode,images:""}).then((function(e){t.$n_success(e),t.init_data(),t.deviceCode=""})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))}))}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},init_data:function(){var t=this;return Object(J["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("taskStationCheckOrder/".concat(t.$route.params.id));case 2:a=e.sent,n=a.data.data.task_station_check_order,t.taskDetail=n,t.items=n.task_station_check_entire_instances.map((function(t){return t.processed_at&&(t.entire_instance.active=!0),t.entire_instance})),t.progress=n.task_station_check_entire_instances_count/n.number;case 7:case"end":return e.stop()}}),e)})))()},check:function(){var t=this;this.$wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){var a=e.resultStr;t.deviceCode=a,t.addToList()}})}}},Zi=Gi,Xi=(a("bb3a"),a("6b1d")),to=a("58a8"),eo=Object(d["a"])(Zi,Yi,Bi,!1,null,"1a7166a5",null),ao=eo.exports;v()(eo,"components",{QCard:O["a"],QCardSection:et["a"],QLinearProgress:Xi["a"],QBadge:to["a"],QInput:nt["a"],QBtn:R["a"],QScrollArea:na["a"],QTable:Rt["a"]});var no=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md q-gutter-md"},[a("q-card",{attrs:{flat:"",bordered:""}},[a("q-card-section",{staticClass:"q-my-xs q-py-xs"},[a("q-select",{staticClass:"q-mt-sm",attrs:{dense:"",outlined:"",options:t.projects,"map-options":"","options-dense":"","option-value":"id","option-label":"name",label:"项目名称","emit-value":""},model:{value:t.project,callback:function(e){t.project=e},expression:"project"}}),a("q-select",{staticClass:"q-mt-md",attrs:{outlined:"",dense:"","options-dense":"",label:"月份",options:t.month},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1),a("div",{staticClass:"row"},t._l(t.data,(function(e){return a("q-card",{key:e.name,class:"col-4 "+(e.finished/e.aggregate===1?"bg-green-11":e.finished/e.aggregate===0?"bg-red-11":"bg-orange-11"),on:{click:function(a){t.maintain_unique_code=e.unique_code}}},[a("q-card-section",{staticClass:"text-h6"},[t._v(t._s(e.name))]),a("q-card-section",[t._v(t._s(e.project_name))]),a("q-card-section",[t._v("完成情况："+t._s(e.finished)+"/"+t._s(e.aggregate))])],1)})),1)],1)])},io=[],oo={components:{},data:function(){return{month:["2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12"],state:1,user_workshop:"",date:"2021-05",maintain_unique_code:"",projects:[],project:"",data:[]}},watch:{project:function(){this.render()},maintain_unique_code:function(){this.render()},date:function(){this.render()}},created:function(){var t=this;this.$http.get("checkProject").then((function(e){t.projects=e.data.data.check_projects})),this.render()},methods:{render:function(){var t=this;this.$http.get("taskStationCheckStatisticForProject",{params:{project_id:this.project,expiring_at:this.date,maintain_unique_code:this.maintain_unique_code}}).then((function(e){t.data=e.data.data.mission_statistic.map((function(t){var a,n;return Object(Ut["a"])(Object(Ut["a"])({},t),{},{finished:null!==(a=null===(n=e.data.data.finish_statistic.find((function(e){return e.unique_code===t.unique_code&&e.project_id===t.project_id})))||void 0===n?void 0:n.aggregate)&&void 0!==a?a:0})}))}))}}},so=oo,co=Object(d["a"])(so,no,io,!1,null,null,null),ro=co.exports;v()(co,"components",{QCard:O["a"],QCardSection:et["a"],QSelect:te["a"],QInput:nt["a"],QIcon:pt["a"],QPopupProxy:Ei["a"],QDate:Pi["a"],QBtn:R["a"]}),v()(co,"directives",{ClosePopup:it["a"]});var lo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md"},[a("q-btn-group",{staticStyle:{height:"3.6rem"},attrs:{push:"",spread:""}},[a("q-btn",{attrs:{push:"",label:"分配检修",icon:"timeline"},on:{click:function(e){return t.$router.push({path:"/task/arrange/"+t.$route.params.id,query:{work_area_unique_code:t.data[0].workAreaUniqueCode}})}}}),a("q-btn",{attrs:{push:"",label:"现场退回",icon:"visibility"},on:{click:function(e){return t.$router.push("/task/return/"+t.$route.params.id)}}}),a("q-btn",{attrs:{push:"",label:"检修完成",icon:"check"},on:{click:function(e){return t.$router.push("/task/complete/"+t.$route.params.id)}}}),a("q-btn",{attrs:{push:"",label:"设备验收",icon:"update"},on:{click:function(e){return t.$router.push("/task/acceptance/"+t.$route.params.id)}}})],1),a("br"),a("q-table",{attrs:{title:"新站任务单："+t.$route.params.id,data:t.data,columns:t.columns,"row-key":"workshop","hide-bottom":""}}),a("q-linear-progress",{staticClass:"q-mt-sm",attrs:{rounded:"",size:"35px",value:t.progress,color:"green"}},[a("div",{staticClass:"absolute-full flex flex-center"},[a("q-badge",{attrs:{color:"white","text-color":"black",label:t.progressLabel}})],1)]),a("br"),a("q-card",{staticClass:"q-pt-none"},[a("q-tabs",{staticClass:"text-grey",attrs:{dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab",{attrs:{name:"tasks",label:"待出所单"}}),a("q-tab",{attrs:{name:"devices",label:"设备列表"}})],1),a("q-separator"),a("q-tab-panels",{attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"tasks"}},[a("div",{staticClass:"text-h6"},[t._v("待出所单")]),a("q-card-section",{staticStyle:{height:"calc(100vh - 520px)","overflow-y":"auto"}},[a("q-list",{directives:[{name:"show",rawName:"v-show",value:0!==t.taskdetails.length,expression:"taskdetails.length !== 0"}],attrs:{bordered:"",separator:""}},t._l(t.taskdetails,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,attrs:{clickable:""},on:{click:function(a){return t.navTask(e.serial_number)}}},[a("q-item-section",[t._v(t._s(e.serial_number))])],1)})),1)],1)],1),a("q-tab-panel",{attrs:{name:"devices"}},[a("q-card-section",{staticStyle:{height:"calc(100vh - 520px)","overflow-y":"auto"}},[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,slidable:!1,showDelete:!1}})],1)],1)],1)],1)],1)},uo=[],po={components:{simpleList:Le},data:function(){return{tab:"tasks",columns:[{name:"workshop",required:!0,label:"车间",align:"left",field:function(t){return t.workshopName},format:function(t){return"".concat(t)},sortable:!1},{name:"station",align:"left",label:"车站",field:"stationName",sortable:!1},{name:"area",align:"left",label:"工区",field:"workAreaName",sortable:!1},{name:"deadline",align:"left",label:"截止日期",field:"expiringAt",sortable:!1}],items:[],data:[],taskdetails:[],progress:0,total:0,finished:1}},computed:{progressLabel:function(){return"任务进度："+this.finished+"/"+this.total}},created:function(){var t=this;this.$http.post("workshopStayOut",{serial_number:this.$route.params.id}).then((function(e){0===e.data.data.length&&(t.tab="devices"),t.taskdetails=e.data.data})),this.$http.post("listDetails",{serial_number:this.$route.params.id}).then((function(e){t.data=[e.data.data],t.progress=e.data.data.workshopOutCount/e.data.data.taskOrderCount,t.total=e.data.data.taskOrderCount,t.finished=e.data.data.workshopOutCount,t.items=e.data.data.entire_instances.data.map((function(t){return 1===t.is_scene_back.code&&(t.entire_instance.status="现场退回"),1===t.is_out&&(t.entire_instance.active=!0),t.entire_instance}))}))},methods:{navTask:function(t){this.$router.push({path:"/depotout/".concat(t),query:{work_area_unique_code:this.data[0].workAreaUniqueCode}})}}},mo=po,ho=a("e7a9"),fo=Object(d["a"])(mo,lo,uo,!1,null,null,null),vo=fo.exports;v()(fo,"components",{QBtnGroup:ho["a"],QBtn:R["a"],QTable:Rt["a"],QLinearProgress:Xi["a"],QBadge:to["a"],QCard:O["a"],QTabs:S["a"],QTab:D["a"],QSeparator:at["a"],QTabPanels:L["a"],QTabPanel:j["a"],QCardSection:et["a"],QList:$e["a"],QItem:I["a"],QItemSection:Qe["a"]}),v()(fo,"directives",{Ripple:Se["a"]});var _o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addToList.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.addToList}})]},proxy:!0}]),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}})],1),a("br"),a("q-card",{staticStyle:{height:"calc(100vh - 260px)","overflow-y":"auto"}},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,slidable:!1}})],1)],1),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"mail",label:"分配检修"},on:{click:t.makeArrange}})],1)],1)])},go=[],bo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{ref:"dialog",on:{hide:t.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("q-card-section",{staticClass:"row items-center q-pb-none"},[a("div",{staticClass:"text-h6"},[t._v("选择检修人")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"85%"}},[a("div",{staticClass:"q-gutter-md"},[a("q-select",{attrs:{filled:"",options:t.personnels,label:"检修人","option-value":"id","option-label":"nickname","emit-value":"","map-options":""},model:{value:t.contact.account_id,callback:function(e){t.$set(t.contact,"account_id",e)},expression:"contact.account_id"}})],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"确认"},on:{click:t.onOKClick}}),a("q-btn",{attrs:{color:"primary",label:"取消"},on:{click:t.onCancelClick}})],1)],1)],1)},yo=[],qo={name:"contact",data:function(){return{personnels:[],contact:{account_id:""}}},methods:{show:function(){var t=this;this.$http.post("personnel",{work_area_unique_code:this.$route.query.work_area_unique_code}).then((function(e){t.personnels=e.data.data})),this.$refs.dialog.show()},hide:function(){this.$refs.dialog.hide()},onDialogHide:function(){this.$emit("hide")},onOKClick:function(){this.$emit("ok",Object(Ut["a"])({},this.contact)),this.hide()},onCancelClick:function(){this.hide()}}},ko=qo,Co=Object(d["a"])(ko,bo,yo,!1,null,"79b77dda",null),wo=Co.exports;v()(Co,"components",{QDialog:Q["a"],QCard:O["a"],QCardSection:et["a"],QSpace:T["a"],QBtn:R["a"],QSeparator:at["a"],QSelect:te["a"],QCardActions:A["a"]}),v()(Co,"directives",{ClosePopup:it["a"]});var $o={components:{simpleList:Le},data:function(){return{items:[],active:!0,deviceCode:""}},methods:{addToList:function(){var t=this;if(""!=this.deviceCode){var e=this.items.map((function(t){return t.identity_code}));-1===e.indexOf(this.deviceCode)?(this.$http.get("entireInstanceByIdentityCode/".concat(this.deviceCode)).then((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data.entire_instance),{},{active:!1}))})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})})),this.deviceCode=""):this.$q.notify({type:"warning",position:"top",message:"此设备已经添加"})}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},makeArrange:function(){var t=this;0!==this.items.length?this.$q.dialog({component:wo,parent:this}).onOk((function(e){console.log(">>>> OK, received",e);var a=Object(Ut["a"])(Object(Ut["a"])({serial_number:t.$route.params.id,identity_codes:t.items.map((function(t){return t.identity_code}))},e),{},{date:t.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")});console.log(a),t.$http.post("overhaul",a).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=[]})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))})):this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},xo=$o,Qo=Object(d["a"])(xo,_o,go,!1,null,"257a3dc4",null),Oo=Qo.exports;v()(Qo,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QCardSection:et["a"]});var So=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addToList.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.addToList}})]},proxy:!0}]),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}})],1),a("br"),a("q-card",{staticStyle:{height:"calc(100vh - 260px)","overflow-y":"auto"}},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,slidable:!1}})],1)],1),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"mail",label:"现场退回"},on:{click:t.makeReturn}})],1)],1)])},Do=[],Lo={components:{simpleList:Le},data:function(){return{items:[],active:!0,deviceCode:""}},methods:{addToList:function(){var t=this;if(""!=this.deviceCode){var e=this.items.map((function(t){return t.identity_code}));-1===e.indexOf(this.deviceCode)?(this.$http.get("entireInstanceByIdentityCode/".concat(this.deviceCode)).then((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data.entire_instance),{},{active:!1}))})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})})),this.deviceCode=""):this.$q.notify({type:"warning",position:"top",message:"此设备已经添加"})}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},makeReturn:function(){var t=this;0!==this.items.length?this.$q.dialog({component:nn,parent:this}).onOk((function(e){console.log(">>>> OK, received",e);var a=Object(Ut["a"])(Object(Ut["a"])({identityCodes:t.items.map((function(t){return t.identity_code}))},e),{},{date:t.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")});console.log(a),t.$http.post("sceneBackIn",a).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=[]})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))})):this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},jo=Lo,Io=Object(d["a"])(jo,So,Do,!1,null,"f0a87570",null),To=Io.exports;v()(Io,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QCardSection:et["a"]});var Ro=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addToList.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.addToList}})]},proxy:!0}]),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}})],1),a("br"),a("q-card",{staticStyle:{height:"calc(100vh - 260px)","overflow-y":"auto"}},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,slidable:!1}})],1)],1),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"mail",label:"设备验收"},on:{click:t.makeAccecpt}})],1)],1)])},Eo=[],Po={components:{simpleList:Le},data:function(){return{items:[],active:!0,deviceCode:""}},methods:{addToList:function(){var t=this;if(""!=this.deviceCode){var e=this.items.map((function(t){return t.identity_code}));-1===e.indexOf(this.deviceCode)?(this.$http.get("entireInstanceByIdentityCode/".concat(this.deviceCode)).then((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data.entire_instance),{},{active:!1}))})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})})),this.deviceCode=""):this.$q.notify({type:"warning",position:"top",message:"此设备已经添加"})}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},makeAccecpt:function(){var t=this;0!==this.items.length?this.$q.dialog({component:nn,parent:this}).onOk((function(e){console.log(">>>> OK, received",e);var a=Object(Ut["a"])(Object(Ut["a"])({identityCodes:t.items.map((function(t){return t.identity_code}))},e),{},{date:t.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")});console.log(a),t.$http.post("checkDevice",a).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=[]})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))})):this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},No=Po,Ao=Object(d["a"])(No,Ro,Eo,!1,null,"339c2980",null),zo=Ao.exports;v()(Ao,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QCardSection:et["a"]});var Yo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-gutter-md"},[a("q-input",{attrs:{outlined:"",autocapitalize:"off",label:"设备码"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addToList.apply(null,arguments)}},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"send"},on:{click:t.addToList}})]},proxy:!0}]),model:{value:t.deviceCode,callback:function(e){t.deviceCode=e},expression:"deviceCode"}})],1),a("br"),a("q-card",{staticStyle:{height:"calc(100vh - 260px)","overflow-y":"auto"}},[a("q-card-section",[a("simpleList",{directives:[{name:"show",rawName:"v-show",value:""!=t.items,expression:"items != ''"}],attrs:{Litems:t.items,slidable:!1}})],1)],1),a("div",{staticClass:"q-pt-md column"},[a("q-btn",{attrs:{color:"primary",icon:"mail",label:"检修完成"},on:{click:t.makeComplete}})],1)],1)])},Bo=[],Wo={components:{simpleList:Le},data:function(){return{items:[],active:!0,deviceCode:""}},methods:{addToList:function(){var t=this;if(""!=this.deviceCode){var e=this.items.map((function(t){return t.identity_code}));-1===e.indexOf(this.deviceCode)?(this.$http.post("overhaulOfSearch",{identity_code:this.deviceCode}).then((function(e){t.items.push(Object(Ut["a"])(Object(Ut["a"])({},e.data.data),{},{active:!1}))})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})})),this.deviceCode=""):this.$q.notify({type:"warning",position:"top",message:"此设备已经添加"})}else this.$q.notify({type:"warning",position:"top",message:"设备码不能为空"})},makeComplete:function(){var t=this;if(0!==this.items.length){var e={identityCodes:this.items.map((function(t){return t.identity_code})),date:this.$date.formatDate(Date.now(),"YYYY-MM-DD HH:mm:ss")};console.log(e),this.$http.post("completeOverhaul",e).then((function(e){t.$q.notify({type:"positive",position:"top",message:e.data.msg}),t.items=[]})).catch((function(e){var a=e.response;t.$q.notify({type:"warning",position:"top",message:a.data.msg})}))}else this.$q.notify({type:"warning",position:"top",message:"无设备"})}}},Mo=Wo,Ho=Object(d["a"])(Mo,Yo,Bo,!1,null,"f71c930e",null),Fo=Ho.exports;v()(Ho,"components",{QInput:nt["a"],QBtn:R["a"],QCard:O["a"],QCardSection:et["a"]}),n["a"].use(wt["a"]);var Ko=[{path:"/",name:"首页",component:Dt},{path:"/login",name:"登录",component:Ht},{path:"/regsiter",name:"注册",component:ge},{path:"/task/list/:id",name:"新站任务详情",class:"bg-grey-4",component:vo,hidden:!0},{path:"/task/home",name:"新站任务",class:"bg-grey-4",component:vi,icon:"assignment",hidden:!0},{path:"/scenetask/home",name:"现场检修任务",class:"bg-grey-4",component:wi,icon:"assignment",hidden:!0},{path:"/scenetask/demo",name:"现场检修任务统计",class:"bg-grey-4",component:ro,icon:"assignment",hidden:!0},{path:"/scenetask/edit/:id?",name:"新建现场检修任务",class:"bg-grey-4",component:zi,hidden:!0},{path:"/scenetask/check/:id",name:"现场检修任务详情",class:"bg-grey-4",component:ao,hidden:!0},{path:"/task/arrange/:id",name:"分配检修任务",class:"bg-grey-4",component:Oo,hidden:!0},{path:"/task/acceptance/:id",name:"设备验收",class:"bg-grey-4",component:zo,hidden:!0},{path:"/task/return/:id",name:"现场退回",class:"bg-grey-4",component:To,hidden:!0},{path:"/task/complete/:id",name:"检修完成",class:"bg-grey-4",component:Fo,hidden:!0},{path:"/depotin",name:"入所",class:"bg-grey-4",component:hn,icon:"move_to_inbox",hidden_inminiapp:!0},{path:"/depotout/:id?",name:"出所",class:"bg-grey-4",component:rn,icon:"unarchive",hidden_inminiapp:!0},{path:"/ininstall",name:"扫码上道",class:"bg-grey-4",component:yn,icon:"file_upload"},{path:"/outinstall",name:"室内外上道",class:"bg-grey-4",component:Qn,icon:"file_upload"},{path:"/uninstall",name:"下道",class:"bg-grey-4",component:In,icon:"get_app"},{path:"/about",name:"安卓接口测试",class:"bg-grey-4",component:Pt,icon:"android",hidden:!0},{path:"/store",name:"入库",class:"bg-grey-4",component:oa,icon:"exit_to_app",hidden_inminiapp:!0},{path:"/scenestore",name:"现场备品入柜",class:"bg-grey-4",component:Ca,icon:"exit_to_app"},{path:"/scrap",name:"报废",class:"bg-grey-4",component:Sa,icon:"delete_sweep"},{path:"/damage",name:"报损",class:"bg-grey-4",component:Ra,icon:"rule",hidden:!0},{path:"/check",name:"盘点",class:"bg-grey-4",component:Ya,icon:"fact_check",hidden_inminiapp:!0},{path:"/bind",name:"现场设备定位",class:"bg-grey-4",component:An,icon:"share_location",hidden:!0},{path:"/test",name:"测试",class:"bg-grey-4",component:di,icon:"bug_report",hidden:!0},{path:"/search",name:"设备综合查询",class:"bg-grey-4",component:Ze,icon:"search",hidden:!0}],Uo=new wt["a"]({routes:Ko});Uo.beforeEach((function(t,e,a){var i=localStorage.getItem("token");"/login"!==t.path&&"/regsiter"!==t.path&&null==i?a({path:"/login"}):(n["a"].prototype.$http.defaults.headers.common["Token"]=i,a())}));var Vo=Uo,Jo=a("2f62");n["a"].use(Jo["a"]);var Go=new Jo["a"].Store({state:{offlineMode:!1,showFab:!1,userInfo:{},miniapp:!1,userLevel:""},mutations:{},actions:{},modules:{}}),Zo=(a("c867"),a("bf69")),Xo=(a("e54f"),a("b05d")),ts=a("2a19"),es=a("436b"),as=a("1b3f"),ns=a("bd4c");n["a"].prototype.$date=ns["b"],n["a"].use(Xo["a"],{config:{loadingBar:{color:"green",size:"3px",position:"top"}},plugins:{Notify:ts["a"],Dialog:es["a"],LoadingBar:as["a"]},lang:Zo["a"]});var is=a("bc3a"),os=a.n(is),ss=G["a"].Storage;if(n["a"].prototype.$http=os.a,window.AndroidWebView){var cs=window.AndroidWebView.ParameterQuery("transmit_url"),rs=window.AndroidWebView.ParameterQuery("target_url");cs?(console.log(cs,rs),os.a.defaults.baseURL="http://".concat(JSON.parse(cs).value,"/api/transmit?target=http://").concat(JSON.parse(rs).value,"/api/pda")):os.a.defaults.baseURL="/api/pda"}else{var ls=ss.get({key:"transmit_url"}),ds=ss.get({key:"target_url"});Promise.all([ls,ds]).then((function(t){var e=Object(Qi["a"])(t,2),a=e[0],n=e[1];console.log("aaaa",a,n),null===a.value&&null===n.value?os.a.defaults.baseURL="/api/pda":""===a.value||null===a.value||"null"===a.value?os.a.defaults.baseURL="http://".concat(n.value,"/api/pda"):os.a.defaults.baseURL="http://".concat(a.value,"/api/transmit?target=http://").concat(n.value,"/api/pda")}))}n["a"].prototype.$n_error=function(t){var e=t.response;ts["a"].create({type:"warning",position:"top",message:e.data.msg})},n["a"].prototype.$n_success=function(t){ts["a"].create({type:"positive",position:"top",message:t.data.msg})},os.a.interceptors.response.use((function(t){return 200==t.data.status?Promise.resolve(t):(ts["a"].create({type:"warning",position:"top",message:t.data.msg}),Promise.reject(t))}),(function(t){return Promise.reject(t)})),n["a"].prototype.$init=function(t){window.AndroidWebView.Init(t)},n["a"].prototype.$reset=function(){window.AndroidWebView.Reset()},n["a"].prototype.$clear=function(){window.AndroidWebView.Clear()},n["a"].prototype.$update=function(){window.AndroidWebView.Update()},n["a"].prototype.$pall=function(){return window.AndroidWebView.ParameterAll()},n["a"].prototype.$pclear=function(){return window.AndroidWebView.ParameterClear()},n["a"].prototype.$pquery=function(t){return window.AndroidWebView.ParameterQuery(t)},n["a"].prototype.$pdelete=function(t){return window.AndroidWebView.ParameterDelete(t)},n["a"].prototype.$pinsert=function(t,e){return window.AndroidWebView.ParameterInsert(t,e)},n["a"].prototype.$pupdate=function(t,e){return window.AndroidWebView.ParameterUpdate(t,e)};var us=a("bb6f"),ps=a.n(us);n["a"].use(ps.a);var ms=a("18a0"),hs=a.n(ms);n["a"].prototype.$wx=hs.a,n["a"].prototype.$in_miniapp=!1,hs.a.miniProgram.getEnv((function(t){t.miniprogram&&(n["a"].prototype.$in_miniapp=!0)}));var fs=a("245e"),vs=a.n(fs);n["a"].prototype.$hbq=vs.a;a("b64b"),a("4e82");var _s=a("6821"),gs=a.n(_s);n["a"].prototype.$sign=function(t,e){var a={},n=Object.assign({},t);n["secret_key"]=e;var i=Object.keys(n);return i.sort().map((function(t){n[t]&&(a[t]=n[t])})),gs()(vs()(a)).toUpperCase()};var bs=a("279c"),ys=a.n(bs),qs=a("b970");a("157a");n["a"].use(qs["a"]),n["a"].prototype.$bcrypt=ys.a,n["a"].config.productionTip=!1,new n["a"]({router:Vo,store:Go,render:function(t){return t(Ct)}}).$mount("#app")},6:function(t,e){},"6f05":function(t,e,a){},7:function(t,e){},8:function(t,e){},"8a48":function(t,e,a){"use strict";a("a18a")},9:function(t,e){},a18a:function(t,e,a){},bb3a:function(t,e,a){"use strict";a("6f05")},c867:function(t,e,a){},d607:function(t,e,a){t.exports=a.p+"img/profile.27a1fe10.svg"},d6db:function(t,e,a){"use strict";a("24d3")},d962:function(t,e,a){"use strict";a("035d")},f588:function(t,e,a){}});
//# sourceMappingURL=app.d350d2ee.js.map